<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Brief theory • terms</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Brief theory">
<meta property="og:description" content="terms">
<meta property="og:image" content="http://nano-optics.ac.nz/terms/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><link rel="stylesheet" type="text/css" href="http://www.x3dom.org/x3dom/src/x3dom.css">
<script type="text/javascript" src="http://www.x3dom.org/x3dom/src/x3dom.js"></script><style>
.x3d_scene {
  max-width: 300px;
    width: 80%;
    height: 80%;
    margin: 1em;
    background: rgb(238,251,255);
    background: radial-gradient(circle, rgba(238,251,255,1) 0%, rgba(212,212,212,1) 100%);
 }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">terms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/Keywords.html">Keywords</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Simple examples</li>
    <li>
      <a href="../articles/01_dimer_spheres/01_dimer_spheres.html">01 dimer spheres</a>
    </li>
    <li>
      <a href="../articles/02_angular_dispersion/02_angular_dispersion.html">02 angular dispersion</a>
    </li>
    <li>
      <a href="../articles/03_nearfield_coreshells/03_nearfield_coreshells.html">03 nearfield coreshells</a>
    </li>
    <li>
      <a href="../articles/04_chiral_dimer_spheroids/04_chiral_dimer_spheroids.html">04 chiral dimer spheroids</a>
    </li>
    <li>
      <a href="../articles/05_quadrature_averaging/05_quadrature_averaging.html">05 quadrature averaging</a>
    </li>
    <li>
      <a href="../articles/06_dielectric_function/06_dielectric_function.html">06 dielectric function</a>
    </li>
    <li>
      <a href="../articles/07_ldoc/07_ldoc.html">07 local degree of chirality</a>
    </li>
    <li>
      <a href="../articles/08_polarimetry/08_polarimetry.html">08 polarimetry</a>
    </li>
    <li>
      <a href="../articles/09_spectrum_near_field/09_spectrum_near_field.html">09 orientation-averaged near field spectrum</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Advanced examples &amp; testing</li>
    <li>
      <a href="../articles/10_shell_absorption/10_shell_absorption.html">10 shell absorption</a>
    </li>
    <li>
      <a href="../articles/11_convergence/11_convergence.html">11 convergence</a>
    </li>
    <li>
      <a href="../articles/12_convergence_VTACS/12_convergence_VTACS.html">12 convergence VTACS</a>
    </li>
    <li>
      <a href="../articles/13_masking/13_masking.html">13 masking</a>
    </li>
    <li>
      <a href="../articles/14_diffractive_chain/14_diffractive_chain.html">14 diffractive chain</a>
    </li>
    <li>
      <a href="../articles/15_quadrimer/15_quadrimer.html">15 quadrimer vs 2 dimers</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Technical notes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Convergence and timing studies</li>
    <li>
      <a href="../articles/101_timing/101_timing.html">101 timing</a>
    </li>
    <li>
      <a href="../articles/102_comparison_schemes/102_comparison_schemes.html">102 comparison of schemes</a>
    </li>
    <li>
      <a href="../articles/104_large_separation/104_large_separation.html">104 large separation</a>
    </li>
    <li>
      <a href="../articles/105_factorised_RTR/105_factorised_RTR.html">105 factorised RTR</a>
    </li>
    <li>
      <a href="../articles/106_balancing/106_balancing.html">106 balancing</a>
    </li>
    <li>
      <a href="../articles/109_individual_absorption/109_individual_absorption.html">109 individual absorption</a>
    </li>
    <li>
      <a href="../articles/110_alpha_tensor/110_alpha_tensor.html">110 alpha tensor</a>
    </li>
    <li>
      <a href="../articles/111_polarised_nf/111_polarised_nf.html">111 polarised OA near-fields</a>
    </li>
    <li>
      <a href="../articles/112_absorption_field/112_absorption_field.html">112 core-shell absorption vs internal fields</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Validation</li>
    <li>
      <a href="../articles/1001_mstm_ff/1001_mstm_ff.html">1001 MSTM far-field</a>
    </li>
    <li>
      <a href="../articles/1003_cda/1003_cda.html">1003 CDA dichroism</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../articles/Indexing.html">Indexing conventions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nano-optics/terms/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Brief theory</h1>
            
            <h4 data-toc-skip class="date">10 February, 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nano-optics/terms/blob/HEAD/vignettes/Theory.Rmd" class="external-link"><code>vignettes/Theory.Rmd</code></a></small>
      <div class="hidden name"><code>Theory.Rmd</code></div>

    </div>

    
    
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script><p>We are interested in solving direct (as opposed to inverse) electromagnetic (EM) scattering problems with multiple spheroidal scatterers. Denoting the EM filed by <span class="math inline">\(\mathbf{E}(\mathbf{r},t) \in \mathbb{C}^{3}\)</span>, where <span class="math inline">\(\mathbf{r}\)</span> is a point in <span class="math inline">\(\mathbb{R}^{3}\)</span> and <span class="math inline">\(t\)</span> is time, we assume  time dependence so that <span class="math inline">\(e^{-i\omega t}\)</span> factors out and the time dimension can be treated completely independently. We also make certain assumptions about the medium and the scatterer material properties, for which the relevant equation to be satisfied is the homogeneous Helmholtz equation, as well as the appropriate boundary conditions (BCs).</p>
<div class="section level3">
<h3 id="homogeneous-helmholtz-equation">Homogeneous Helmholtz equation<a class="anchor" aria-label="anchor" href="#homogeneous-helmholtz-equation"></a>
</h3>
<p>All contributions to the total EM field (“radiation”), including the incident and the scattered fields, are represented by solutions of the vector Helmholtz equation <span class="math display">\[\begin{equation}\label{eqn:vectorHelmholtz}
\nabla^{2}\mathbf{E}+ k^{2}\mathbf{E}= 0,
\end{equation}\]</span> where <span class="math inline">\(\nabla^{2}\)</span> is the vector Laplacian, <span class="math inline">\(\mathbf{E}(\mathbf{r}):\mathbb{R}^{3} \mapsto \mathbb{C}^{3}\)</span> must be divergence-free (i.e.~<span class="math inline">\(\nabla\cdot\mathbf{E}= 0\)</span>), and <span class="math inline">\(k \in \mathbb{C}\)</span> is the  or , related to the  <span class="math inline">\(\mathbf{k} \in \mathbb{C}^3\)</span>  <span class="math display">\[\begin{equation}
k^{2}=\mathbf{k}\cdot\mathbf{k} = \frac{\omega^2}{c^2}\epsilon(\omega) = \frac{4\pi^2}{\lambda^2}\epsilon(\lambda),
\end{equation}\]</span> where <span class="math inline">\(\omega = 2\pi c / \lambda\)</span> is the angular frequency, <span class="math inline">\(c\)</span> is the speed of light, <span class="math inline">\(\lambda\)</span> is the wavelength, and <span class="math inline">\(\epsilon\)</span> is the frequency-/wavelength-dependent dielectric function. It is often convenient to write <span class="math inline">\(\mathbf{k} = k\mathbf{n}\)</span>, where <span class="math inline">\(\mathbf{n} \in \mathbb{C}^3\)</span> satisfies <span class="math inline">\(\mathbf{n} \cdot \mathbf{n} = 1\)</span>, but is not necessarily a unit vector. In Cartesian coordinates <span class="math inline">\((x,y,z)\)</span> it is relatively straightforward to verify that a stationary  of the form <span class="math inline">\(\mathbf{E}_{0}\exp{(i\mathbf{\mathbf{k}\cdot\mathbf{r}})}\)</span> is a solution of () for any constant  <span class="math inline">\(\mathbf{E}_{0} \in \mathbb{C}^{3}\)</span> satisfying <span class="math inline">\(\mathbf{E}_{0} \cdot \mathbf{k} = 0\)</span>, since EM waves are transverse.</p>
<p>The solution must also satisfy the appropriate BCs at interfaces and/or infinity. Given the geometry of problems we address, the BCs are better expressed in spherical polar coordinates <span class="math inline">\((r,\theta,\phi)\)</span>, with the general solution to () being a linear combination of  waves. To build up the relevant formulae, it is useful to first consider the  Helmholtz equation <span class="math display">\[\begin{equation}\label{eqn:scalarHelmholtz}
\nabla^{2}E + k^{2}E = 0,
\end{equation}\]</span> where <span class="math inline">\(E(\mathbf{r}):\mathbb{R}^{3} \mapsto \mathbb{C}\)</span> and <span class="math inline">\(\nabla^{2}\)</span> is the scalar Laplacian.</p>
</div>
<div class="section level3">
<h3 id="scalar-and-vector-spherical-waves">Scalar and vector spherical waves<a class="anchor" aria-label="anchor" href="#scalar-and-vector-spherical-waves"></a>
</h3>
<p>In spherical polar coordinates, () is satisfied by linear combinations of <span class="math display">\[\begin{equation}
\psi_{nm}^{(\zeta)}(k\mathbf{r}) = z_{n}^{(\zeta)}(kr) Y_{nm}(\theta,\phi),
\end{equation}\]</span> where <span class="math inline">\(z_{n}^{(\zeta)}\)</span> are  Bessel functions of kind <span class="math inline">\(\zeta\in\{1,2,3,4\}\)</span> and order <span class="math inline">\(n=0\dots\infty\)</span>, and <span class="math inline">\(Y_{nm}\)</span> are the spherical harmonics with <span class="math inline">\(|m| \leq n\)</span>, defined using the Condon-Shortley phase. Hence, a general solution to () can be expressed as <span class="math display">\[\begin{equation} \label{eqn:ScalGenSol}
E^{(\zeta)}(\mathbf{r}; k) = \sum_{p} a_{p} \psi_{p}^{(\zeta)}(k\mathbf{r}) \equiv \mathbf{a}\cdot \pmb{\psi}^{(\zeta)},
\end{equation}\]</span> where <span class="math inline">\(\pmb{\psi}^{(\zeta)}\)</span> is a  vector, <span class="math inline">\(\mathbf{a}\in \mathbb{C}\)</span> is a vector of coefficients (<span class="math inline">\(a_{p} \in \mathbb{C}\)</span>), and <span class="math display">\[\begin{equation}
p(n,m)=n(n+1)+m
\end{equation}\]</span> is a composite index introduced for convenience, such that <span class="math display">\[\begin{eqnarray}
n &amp; = &amp; \mathrm{Int}(\sqrt{p}) \\ 
m &amp; = &amp; p-n(n+1).
\end{eqnarray}\]</span> Note that, while in principle <span class="math inline">\(p\)</span> can run from <span class="math inline">\(0\)</span> up to <span class="math inline">\(\infty\)</span>, in practice the series in () is made finite by truncating at some maximum multipole order <span class="math inline">\(n_{\rm max}\)</span>, so that the column vectors <span class="math inline">\(\mathbf{a} \in \mathbb{C}^{p_{\rm max}}\)</span> and <span class="math inline">\(\pmb{\psi}^{(\zeta)} \in \mathbb{C}^{p_{\rm max}}\)</span> are of finite length <span class="math inline">\(p_{\rm max} = n_{\rm max}^{2} + 2n_{\rm max}\)</span>.</p>
<p>For our purposes we only require <span class="math inline">\(\zeta = 1\)</span> (<span class="math inline">\(z_{n}^{(1)} = j_{n}\)</span>, spherical Bessel functions of the first kind) and <span class="math inline">\(\zeta = 3\)</span> (<span class="math inline">\(z_{n}^{(3)} = h_{n}\)</span>, spherical Hankel functions of the first kind), referred to as the  and the  functions, respectively, which are linearly independent. Hence, for brevity and notational convenience we may refer to <span class="math inline">\(\psi_{nm}^{(3)}\)</span> as simply <span class="math inline">\(\psi_{nm}\)</span>, and <span class="math inline">\(\psi_{nm}^{(1)}\)</span> as <span class="math inline">\(\widetilde{\psi}_{nm}\)</span>. Furthermore, the tilde will also be placed over the coefficients (e.g.~<span class="math inline">\(\widetilde{\mathbf{a}}\)</span>) to explicitly indicate the regular basis-set flavour. Note that the existence of two linearly independent basis-sets stems from the fact that the underlying (Helmholtz) partial differential equation is of second order and is homogeneous.</p>
<p>Now, solving () in spherical polar coordinates leads to two sets of vector-valued functions <span class="math display">\[\begin{eqnarray}
\mathbf{M}_{nm}^{(\zeta)}(k\mathbf{r}) &amp; = &amp; \frac{1}{\sqrt{n(n+1)}} \nabla \times (\psi_{nm}^{(\zeta)} (k\mathbf{r})\mathbf{r}), \\
\mathbf{N}_{nm}^{(\zeta)}(k\mathbf{r}) &amp; = &amp; \frac{1}{k} \nabla \times \mathbf{M}_{nm}^{(\zeta)}(k\mathbf{r}). 
\end{eqnarray}\]</span> <span class="math inline">\(\mathbf{M}_{nm}^{(\zeta)}\)</span> and <span class="math inline">\(\mathbf{N}_{nm}^{(\zeta)}\)</span> for <span class="math inline">\(n=0\dots\infty\)</span> and <span class="math inline">\(|m| \leq n\)</span> form a complete set of mutually orthogonal angular-dependent functions, independent of <span class="math inline">\(\zeta\)</span>. That is, <span class="math display">\[\begin{equation} \label{eqn:orthogonality}
\int_{\phi=0}^{2\pi} \int_{\theta=0}^{\pi} \mathbf{A}_{nm}^{(\zeta)*}\mathbf{B}_{n'm'}^{(\zeta')} \sin\theta \mathrm{d}\theta \mathrm{d}\phi =   \delta_{nn'} \delta_{mm'} \delta_{\mathbf{AB}} f_{n}^{(\mathbf{A},\zeta,\zeta')} (kr),
\end{equation}\]</span> where <span class="math inline">\(\mathbf{A}\)</span> and <span class="math inline">\(\mathbf{B}\)</span> are placeholders for <span class="math inline">\(\mathbf{M}\)</span> and <span class="math inline">\(\mathbf{N}\)</span>, <span class="math inline">\(\mathbf{A}_{nm}^{(\zeta)*}\)</span> denotes the complex conjugate of <span class="math inline">\(\mathbf{A}_{nm}^{(\zeta)}\)</span>, and <span class="math inline">\(\delta_{ij}\)</span> is the Kronecker delta. The radial function <span class="math inline">\(f_{n}^{(\mathbf{A}, \zeta,\zeta')}(kr)\)</span> is actually a functional of <span class="math inline">\(j_{n}(kr)\)</span> and/or <span class="math inline">\(h_{n}(kr)\)</span>, depending on <span class="math inline">\(\zeta\)</span> and <span class="math inline">\(\zeta'\)</span>, and its exact form also depends on whether <span class="math inline">\(\mathbf{A}\)</span> is <span class="math inline">\(\mathbf{M}\)</span> or <span class="math inline">\(\mathbf{N}\)</span>.</p>
<p>A general  solution to (), up to a maximum multipole index <span class="math inline">\(n_{\rm max}\)</span>, can be expressed as <span class="math display">\[\begin{eqnarray}
\widetilde{\mathbf{E}}({\bf r}; k) &amp; = &amp; \sum\limits_{n=1}^{n_{\rm max}} \sum\limits_{m=-n}^{n} [\widetilde{c}_{1,nm}\widetilde{\bf M}_{nm}(k{\bf r}) + \widetilde{c}_{2,nm}\widetilde{\bf N}_{nm}(k{\bf r})] \nonumber \\
&amp;=&amp; \sum_{q=1}^{2}\sum_{p=1}^{p_{\rm max}} \widetilde{\mathbf{w}}_{qp}(k\mathbf{r}) \widetilde{c}_{qp}  \nonumber \\
&amp;=&amp; \sum_{l=1}^{l_{\rm max}} \widetilde{\mathbf{w}}_{l}(k\mathbf{r}) \widetilde{c}_{l} ~ \equiv ~ \widetilde{\mathbf{W}}(k\mathbf{r}) \widetilde{\mathbf{c}}, \label{eqn:VectorGenSol}
\end{eqnarray}\]</span> where <span class="math inline">\(\widetilde{\mathbf{c}}\in \mathbb{C}^{l_{\rm max}}\)</span> is a column vector of coefficients, <span class="math inline">\(\widetilde{\mathbf{W}}\)</span> is a  of dimension <span class="math inline">\(3\times l_{\rm max}\)</span> (i.e. a row vector composed of column vectors <span class="math inline">\(\widetilde{\mathbf{w}}_{l(q=1,n,m)} = \widetilde{\mathbf{M}}_{nm}\)</span> and <span class="math inline">\(\widetilde{\mathbf{w}}_{l(q=2,n,m)} = \widetilde{\mathbf{N}}_{nm}\)</span>), and <span class="math inline">\(l_{\rm max}\)</span> is the maximal value of another, more convenient, composite index <span class="math display">\[\begin{eqnarray}
l(q,n,m; n_{\rm max}) &amp; = &amp; (q-1)p_{\rm max} + p(n,m) \nonumber \\
&amp; = &amp; (q-1)n_{\rm max}(n_{\rm max} + 2) + n(n+1) + m \label{eqn:defLindex} \\
&amp; \leq &amp; l_{\rm max} ~=~2n_{\rm max}(n_{\rm max} + 2), \label{eqn:defLmax}
\end{eqnarray}\]</span> where <span class="math inline">\(q \in \{1,2\}\)</span> is sometimes referred to as the  or  index, which is used to distinguish between the <span class="math inline">\(\mathbf{M}\)</span> and <span class="math inline">\(\mathbf{N}\)</span> functions.</p>
<p>The irregular variant of () is obtained by simply removing the overhead tildes (e.g.~<span class="math inline">\(\widetilde{\mathbf{W}}\to \mathbf{W}\)</span>), which corresponds to switching the radial dependence from <span class="math inline">\(j_{n}(kr)\)</span> to <span class="math inline">\(h_{n}(kr)\)</span> throughout. Also, the most general solution to () is actually given by the superposition of regular and irregular solutions: <span class="math display">\[\begin{equation}
\mathbf{E}+ \widetilde{\mathbf{E}}= \mathbf{W}\mathbf{c}+ \widetilde{\mathbf{W}}\widetilde{\mathbf{c}}.
\end{equation}\]</span></p>
</div>
<div class="section level3">
<h3 id="linear-superposition-approach-and-the-t-matrix-ansatz">Linear superposition approach and the T-matrix ansatz<a class="anchor" aria-label="anchor" href="#linear-superposition-approach-and-the-t-matrix-ansatz"></a>
</h3>
<p>Outside a given scatterer, the total field <span class="math inline">\(\mathbf{E}_{\rm tot}(\bf r) = \widetilde{\mathbf{E}}_{\rm inc}({\bf r}) + \mathbf{E}_{\rm sca}({\bf r})\)</span> is partitioned into a known incident contribution <span class="math inline">\(\widetilde{\mathbf{E}}_{\rm inc}({\bf r})\)</span> and unknown scattered contribution <span class="math inline">\(\mathbf{E}_{\rm sca}({\bf r})\)</span>. Both partitions are expanded in terms of VSWs up to some multipole order <span class="math inline">\(n_{\rm max}\)</span>, <span class="math display">\[\begin{eqnarray}
\widetilde{\mathbf{E}}_{\rm inc}({\bf r}) &amp; = &amp; E \widetilde{\mathbf{W}}(\mathbf{r}) \widetilde{\mathbf{c}}_{\rm inc}, \\
\mathbf{E}_{\rm sca}({\bf r}) &amp; = &amp; E \mathbf{W}(\mathbf{r}) \mathbf{c}_{\rm sca},
\end{eqnarray}\]</span> where <span class="math inline">\(E\)</span> is a parameter determining the field amplitude (usually <span class="math inline">\(E = |\widetilde{\mathbf{E}}_{\rm inc} |\)</span>), and <span class="math inline">\(\widetilde{\mathbf{c}}_{\rm inc}\in \mathbb{C}^{l_{\rm max}}\)</span> with <span class="math inline">\(\mathbf{c}_{\rm sca} \in \mathbb{C}^{l_{\rm max}}\)</span> are the incident and scattered coefficients, respectively. The association of <span class="math inline">\(\widetilde{\mathbf{E}}_{\rm inc}\)</span> with regular (or ) and <span class="math inline">\(\mathbf{E}_{\rm sca}\)</span> with irregular (or ) VSWs is a choice motivated by physical reasoning: (i) <span class="math inline">\(\widetilde{\mathbf{E}}_{\rm inc}(\mathbf{r})\)</span> ought to be well defined everywhere within a finite distance from the origin, which rules out irregular VSWs due to their singular behaviour at <span class="math inline">\(\mathbf{r}= 0\)</span>; and (ii) <span class="math inline">\(\mathbf{E}_{\rm sca}(\mathbf{r})\)</span> ought to satisfy the outgoing (Sommerfeld?) BCs, requiring that <span class="math inline">\(|\mathbf{E}_{\rm sca}(\mathbf{r})| \to 0\)</span> at a particular (?) rate as <span class="math inline">\(|\mathbf{r}| \to \infty\)</span>, which rules out regular VSWs due to their divergence in the far field (?). Given the linearity of the governing (Helmholtz) equations, imposition of particular BCs at the scatterer’s surface introduces a linear dependence among <span class="math inline">\(\widetilde{\mathbf{c}}_{\rm inc}\)</span> and <span class="math inline">\(\mathbf{c}_{\rm sca}\)</span>, causing them to satisfy a relation of the form <span class="math display">\[\begin{equation} \label{eqn:genTmatrix}
\mathbf{c}_{\rm sca} = \mathbf{T}\, \widetilde{\mathbf{c}}_{\rm inc},
\end{equation}\]</span> where <span class="math inline">\(\mathbf{T}\)</span> is the so-called “transition” or “transfer” matrix (<span class="math inline">\(T\)</span>-matrix for short), which depends on the scatterer characteristics and is independent of <span class="math inline">\(\widetilde{\mathbf{c}}_{\rm inc}\)</span>. The <span class="math inline">\(T\)</span>-matrix elements are (?) determined by matching the BCs over the scatterer’s surface in a particular way, which is generally a non-trivial task. However, for a spherically symmetric, homogeneous scatterer centred at the origin, <span class="math inline">\(\mathbf{T}\)</span> is a diagonal matrix with the diagonal elements determined analytically by Mie theory. <span class="math inline">\(T\)</span>-matrices can be calculated numerically for spheroids, as well as more general, axially symmetric scatterers, and… For multiple scatterers, the collective <span class="math inline">\(T\)</span>-matrix can be built up iteratively from the individual one-body T-matrices.</p>
</div>
<div class="section level2">
<h2 id="transformation-under-rotationtranslation-of-coordinates">Transformation under rotation/translation of coordinates<a class="anchor" aria-label="anchor" href="#transformation-under-rotationtranslation-of-coordinates"></a>
</h2>
<p>In multiple scattering problems it is often either necessary or simply more convenient to express the same (partial) field in terms of different basis-sets, mutually related by a translation and/or rotation of the coordinate system. This section is concerned with relations between VSW basis-sets or coefficients defined in different reference frames.</p>
<div class="section level3">
<h3 id="rotation">Rotation<a class="anchor" aria-label="anchor" href="#rotation"></a>
</h3>
<p>Let <span class="math inline">\((\theta_{1},\phi_{1})\)</span> and <span class="math inline">\((\theta_{2},\phi_{2})\)</span> be the spherical angles of the same vector <span class="math inline">\(\mathbf{r}\)</span> in coordinate systems <span class="math inline">\(1\)</span> and <span class="math inline">\(2\)</span>, respectively, sharing the same origin. If coordinate system <span class="math inline">\(2\)</span> is obtained by rotating coordinate system <span class="math inline">\(1\)</span> through Euler angles <span class="math inline">\((\alpha,\beta,\gamma)\)</span>, here defined in the “<span class="math inline">\(zyz\)</span>” convention with <span class="math inline">\(0 \leq \alpha &lt; 2\pi\)</span>, <span class="math inline">\(0 \leq \beta \leq \pi\)</span>, and <span class="math inline">\(0 \leq \gamma &lt; 2\pi\)</span>, then <span class="math display">\[\begin{eqnarray} \label{eqn:rotTrans}
\psi_{nm}(kr,\theta_{2},\phi_{2}) &amp; = &amp; \sum_{\mu=-n}^{n} \psi_{n\mu}(kr,\theta_{1},\phi_{1}) D_{\mu m}^{n}(\alpha,\beta,\gamma), \\
\psi_{nm}(kr,\theta_{1},\phi_{1}) &amp; = &amp; \sum_{\mu=-n}^{n} \psi_{n\mu}(kr,\theta_{2},\phi_{2}) D_{\mu m}^{n}(-\gamma,-\beta,-\alpha),
\end{eqnarray}\]</span> where <span class="math inline">\(D_{\mu m}^{n} = e^{-i\mu\alpha}d_{\mu m}^{n}(\beta) e^{-im\gamma}\)</span> and <span class="math inline">\(d_{\mu m}^{n}\)</span> are the Wigner <span class="math inline">\(D\)</span>- and <span class="math inline">\(d\)</span>-functions. Conveniently, <span class="math inline">\(\widetilde{\psi}_{nm}\)</span>, <span class="math inline">\(\widetilde{\mathbf{M}}_{nm}\)</span>, <span class="math inline">\(\widetilde{\mathbf{N}}_{nm}\)</span>, <span class="math inline">\(\mathbf{M}_{nm}\)</span> and <span class="math inline">\(\mathbf{N}_{nm}\)</span> transform in exactly the same manner under rotation, so substituting <span class="math inline">\(\psi_{nm}\)</span> by a desired basis function in () will give the appropriate expression. See equations (5.23)-(5.24) of Ref. for details. In our nomenclature, a basis set <span class="math inline">\(\mathbf{W}^{(2)} \equiv \mathbf{W}(k\mathbf{r}_{2})\)</span> in coordinate system <span class="math inline">\(2\)</span> is related to <span class="math inline">\(\mathbf{W}^{(1)} \equiv \mathbf{W}(k\mathbf{r}_{1})\)</span> in coordinate system <span class="math inline">\(1\)</span> via <span class="math display">\[\begin{equation} \label{eqn:basisRot}
\mathbf{W}^{(2)} = \mathbf{W}^{(1)} \mathbf{R}(\alpha,\beta,\gamma)
\end{equation}\]</span> where <span class="math inline">\(\mathbf{R}(\alpha,\beta,\gamma)\)</span> is a unitary block-diagonal matrix (of size <span class="math inline">\(l_{\rm max} \times l_{\rm max}\)</span>), satisfying <span class="math display">\[\begin{equation}
\mathbf{R}^{-1}(\alpha,\beta,\gamma) = \mathbf{R}^{\dagger}(\alpha,\beta,\gamma) = \mathbf{R}(-\gamma,-\beta,-\alpha)
\end{equation}\]</span> and the matrix elements given by <span class="math display">\[\begin{equation}
R_{ll'}(\alpha,\beta,\gamma) = \delta_{qq'}\delta_{nn'} D_{m'm}^{n}(\alpha,\beta,\gamma), 
\end{equation}\]</span> where the index <span class="math inline">\(l(q,n,m)\)</span> is defined in (). Note that () also applies to regular waves <span class="math inline">\(\widetilde{\mathbf{W}}\)</span>. Now, if a (regular or irregular) spherical wave expansion is described by a vector of coefficients <span class="math inline">\(\mathbf{c}^{(1)}\)</span> in coordinate system <span class="math inline">\(1\)</span>, as well as <span class="math inline">\(\mathbf{c}^{(2)}\)</span> in coordinate system <span class="math inline">\(2\)</span>, then <span class="math display">\[\begin{equation} \label{eqn:rotMat}
\mathbf{c}^{(2)} = \mathbf{R}^{\dagger}(\alpha,\beta,\gamma) \mathbf{c}^{(1)},
\end{equation}\]</span> which follows from equating the field expansions and using (), i.e. </p>
<p>Let us re-label coordinate system <span class="math inline">\(1\)</span> as <span class="math inline">\(G\)</span> to indicate a global, space-fixed reference frame, and coordinate system <span class="math inline">\(2\)</span> as <span class="math inline">\(L\)</span> for local, scatterer-fixed frame. A <span class="math inline">\(T\)</span>-matrix <span class="math inline">\(\mathbf{T}^{(L)}\)</span> expressed in the local frame is transformed into <span class="math inline">\(\mathbf{T}^{(G)} = \mathbf{R}\mathbf{T}^{(L)} \mathbf{R}^{\dagger}\)</span> in the global frame, where <span class="math inline">\(\mathbf{R}(\alpha,\beta,\gamma)\)</span> depends on the Euler angles <span class="math inline">\((\alpha,\beta,\gamma)\)</span> that rotate frame <span class="math inline">\(G\)</span> onto frame <span class="math inline">\(L\)</span> (as opposed to <span class="math inline">\(L\)</span> onto <span class="math inline">\(G\)</span>). For explanation, consider <span class="math display">\[\begin{eqnarray*}
\mathbf{c}_{\rm sca}^{(L)} &amp; = &amp; \mathbf{T}^{(L)}\widetilde{\mathbf{c}}_{\rm inc}^{(L)} \\
\mathbf{R}^{\dagger} \mathbf{c}_{\rm sca}^{(G)} &amp; = &amp; \mathbf{T}^{(L)}\mathbf{R}^{\dagger} \widetilde{\mathbf{c}}_{\rm inc}^{(G)} \\
\mathbf{c}_{\rm sca}^{(G)} &amp; = &amp; \underbrace{\mathbf{R}\mathbf{T}^{(L)}\mathbf{R}^{\dagger}}_{\mathbf{T}^{(G)}} \widetilde{\mathbf{c}}_{\rm inc}^{(G)} \implies \mathbf{T}^{(G)} = \mathbf{R}\mathbf{T}^{(L)} \mathbf{R}^{\dagger}.
\end{eqnarray*}\]</span></p>
<p>If the scatterer is rotationally symmetric about the local <span class="math inline">\(z\)</span>-axis, which is tilted by spherical polar angles <span class="math inline">\((\theta,\phi)\)</span> relative to the global <span class="math inline">\(z\)</span>-axis, then <span class="math inline">\(\alpha = \phi\)</span>, <span class="math inline">\(\beta = \theta\)</span>, and the value of <span class="math inline">\(\gamma\)</span> is irrelevant due to axial symmetry, so we can choose <span class="math inline">\(\gamma = 0\)</span> to have <span class="math inline">\(\mathbf{T}^{(G)} = \mathbf{R}(\phi,\theta,0) \mathbf{T}^{(L)} \mathbf{R}(0,-\theta,-\phi)\)</span>. See Sec.,5.2 of Ref.~ for more details.</p>
</div>
<div class="section level3">
<h3 id="translation">Translation<a class="anchor" aria-label="anchor" href="#translation"></a>
</h3>
<p>Consider a point <span class="math inline">\(P\)</span> with coordinates <span class="math inline">\(\mathbf{r}_1\)</span> in coordinate systems <span class="math inline">\(1\)</span>, with the origin at <span class="math inline">\(O_{1}\)</span>. If we choose another origin <span class="math inline">\(O_{2}\)</span> with coordinates <span class="math inline">\(\mathbf{r}_{12}\)</span> relative to <span class="math inline">\(O_{1}\)</span>, then the new coordinates of <span class="math inline">\(P\)</span> relative to <span class="math inline">\(O_{2}\)</span> will be <span class="math inline">\(\mathbf{r}_{2} = \mathbf{r}_{1} - \mathbf{r}_{12}\)</span>, as illustrated in Fig.~. The translation-addition theorem for vector spherical waves states that, in the limit <span class="math inline">\(n_{\rm max} \to \infty\)</span>, <span class="math display">\[\begin{eqnarray}
\mathbf{W}(k\mathbf{r}_1) &amp; = &amp; \left\{
\begin{array}{lcl}
\mathbf{W}(k\mathbf{r}_2) \widetilde{\mathbf{O}}(k\mathbf{r}_{12}), &amp; {\rm if} &amp; r_{2} &gt; r_{12},  \\
\widetilde{\mathbf{W}}(k\mathbf{r}_2) \mathbf{O}(k\mathbf{r}_{12}), &amp; {\rm if} &amp; r_2 &lt; r_{12},
\end{array} \right. \label{eqn:iVTACS1} \\
\widetilde{\mathbf{W}}(k\mathbf{r}_1) &amp; = &amp; \quad ~\widetilde{\mathbf{W}}(k\mathbf{r}_2) \widetilde{\mathbf{O}}(k\mathbf{r}_{12}), \label{eqn:rVTACS1}
\end{eqnarray}\]</span> where <span class="math inline">\(\widetilde{\mathbf{O}}(k\mathbf{r}_{12})\)</span> and <span class="math inline">\(\mathbf{O}(k\mathbf{r}_{12})\)</span> are (<span class="math inline">\(l_{\rm max} \times l_{\rm max}\)</span>) matrices of regular and irregular translation-addition coefficients (TACs), respectively. Note the conditional statement for irregular waves: the transformation depends on the relative length of <span class="math inline">\(\mathbf{r}_{2}\)</span> and <span class="math inline">\(\mathbf{r}_{12}\)</span>. In Fig.~, an irregular basis centred at <span class="math inline">\(O_{1}\)</span> is mapped onto a regular basis centred at <span class="math inline">\(O_{2}\)</span> via the irregular TACs. However, if <span class="math inline">\(O_{2}\)</span> were to the left of the bisector, so that <span class="math inline">\(r_{2} &gt; r_{12}\)</span>, then the irregular basis centred at <span class="math inline">\(O_{1}\)</span> would be mapped onto an irregular basis centred at <span class="math inline">\(O_{2}\)</span> via the regular TACs. [What exactly happens when <span class="math inline">\(r_{12} = r_{2}\)</span>, near the bisector, or if one simply uses the wrong expression?] Perhaps a more helpful interpretation is that, if the origin is translated by <span class="math inline">\(\mathbf{r}_{12}\)</span> (from <span class="math inline">\(O_{1}\)</span> to <span class="math inline">\(O_{2}\)</span>), then at points with the new coordinates <span class="math inline">\(\mathbf{r}_{2}\)</span> satisfying <span class="math inline">\(r_{2} &lt; r_{12}\)</span> (i.e.~within a ball of radius <span class="math inline">\(r_{12}\)</span>) the irregular waves are transformed into regular waves, and at all other points the irregular waves remain irregular. Why? To better handle the singularity in the irregular waves, I suppose…</p>
<p>Note that <span class="math inline">\(O_{1}\)</span> and <span class="math inline">\(O_{2}\)</span> are themselves points with coordinates <span class="math inline">\(\mathbf{x}_{1}\)</span> and <span class="math inline">\(\mathbf{x}_{2}\)</span>, respectively, in some designated global “laboratory” frame with a fixed origin <span class="math inline">\(\mathbf{x}_{0}\)</span>. If we denote the lab-frame coordinates of <span class="math inline">\(P\)</span> by <span class="math inline">\(\mathbf{r}\)</span>, then <span class="math inline">\(\mathbf{r}_{1} = \mathbf{r}- \mathbf{x}_{1}\)</span>, <span class="math inline">\(\mathbf{r}_{2} = \mathbf{r}- \mathbf{x}_{2}\)</span>, and <span class="math inline">\(\mathbf{r}_{12} = \mathbf{r}_{1} - \mathbf{r}_{2} = \mathbf{x}_{2} - \mathbf{x}_{1} \equiv \mathbf{x}_{21}\)</span>. Hence, we follow Stout_et al_ and adopt the shorthand notation <span class="math inline">\(\widetilde{\mathbf{O}}^{(i,j)} \equiv \widetilde{\mathbf{O}}(k\mathbf{x}_{ij}) = \widetilde{\mathbf{O}}(k\mathbf{r}_{ji})\)</span>, and likewise for <span class="math inline">\(\mathbf{O}^{(i,j)}\)</span>, yielding <span class="math display">\[\begin{eqnarray}
\mathbf{W}^{(i)} &amp; = &amp; \left\{
\begin{array}{lcl}
\mathbf{W}^{(j)} \widetilde{\mathbf{O}}^{(j,i)}, &amp; {\rm if} &amp; r_{j} &gt; r_{ij},  \\
\widetilde{\mathbf{W}}^{(j)} \mathbf{O}^{(j,i)}, &amp; {\rm if} &amp; r_j &lt; r_{ij},
\end{array} \right. \label{eqn:iVTACS2} \\
\widetilde{\mathbf{W}}^{(i)} &amp; = &amp; \quad ~\widetilde{\mathbf{W}}^{(j)} \widetilde{\mathbf{O}}^{(j,i)}. \label{eqn:rVTACS2}
\end{eqnarray}\]</span> Note the reversal of indices <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> in <span class="math inline">\(\mathbf{x}_{ij} = \mathbf{r}_{ji}\)</span>, which has caused some confusion in the past.</p>
<p>To express the translation-addition theorem in terms of the coefficients (<span class="math inline">\(\mathbf{c}\)</span>) of a VSW expansion, multiply (from the right) both sides of equations () and () by column vector <span class="math inline">\(\mathbf{c}^{(i)}\)</span>, where the superscript (<span class="math inline">\(i\)</span>) indicates where the VSW expansion is centred. From inspection of the right-hand side we find that <span class="math display">\[\begin{eqnarray}
\mathbf{c}^{(j)} &amp; = &amp; \widetilde{\mathbf{O}}^{(j,i)} \mathbf{c}^{(i)}, \quad {\rm if} \quad r_{j} &gt; r_{ij}, \label{eqn:iVTACS3a}  \\
\widetilde{\mathbf{c}}^{(j)} &amp; = &amp; \mathbf{O}^{(j,i)} \mathbf{c}^{(i)}, \quad {\rm if} \quad r_{j} &lt; r_{ij}, \label{eqn:iVTACS3b} \\
\widetilde{\mathbf{c}}^{(j)} &amp; = &amp; \widetilde{\mathbf{O}}^{(j,i)}\widetilde{\mathbf{c}}^{(i)}. \label{eqn:rVTACS3}
\end{eqnarray}\]</span> Note that (), () and () are in a similar form to the rotation equation (). Also, it is worth reiterating that the above equations hold exactly only in the limit of <span class="math inline">\(n_{\rm max} \to \infty\)</span>.</p>
</div>
<div class="section level3">
<h3 id="factorized-translation-involving-rotation">Factorized translation (involving rotation)<a class="anchor" aria-label="anchor" href="#factorized-translation-involving-rotation"></a>
</h3>
<p>A general translation, from <span class="math inline">\(\mathbf{x}_{i}\)</span> to <span class="math inline">\(\mathbf{x}_{j}\)</span> by <span class="math inline">\(\mathbf{x}_{ji} = \mathbf{r}_{ij} = (r_{ij},\theta_{ij},\phi_{ij})\)</span>, can be separated into three steps:</p>
<ol style="list-style-type: decimal">
<li>Rotation of the local frame to align the <span class="math inline">\(z\)</span>-axis with the <span class="math inline">\(\mathbf{r}_{ij}\)</span> vector. In the <span class="math inline">\(zyz\)</span> convention, the appropriate Euler angles are <span class="math inline">\(\alpha= \phi_{ij}\)</span>, <span class="math inline">\(\beta = \theta_{ij}\)</span>, and <span class="math inline">\(\gamma = 0\)</span>.</li>
<li>Axial translation along the rotated local <span class="math inline">\(z\)</span>-axis by <span class="math inline">\(r_{ij}\)</span>.</li>
<li>Rotation of the local frame to realign the <span class="math inline">\(z\)</span>-axis with the original orientation. The appropriate Euler angles are <span class="math inline">\(\alpha' = -\gamma = 0\)</span>, <span class="math inline">\(\beta' = -\beta = -\theta_{ij}\)</span>, and <span class="math inline">\(\gamma' = -\alpha = - \phi_{ij}\)</span>.</li>
</ol>
<p>This factorisation can be expressed in matrix form as <span class="math display">\[\begin{equation}\label{eqn:rot-tranz-rot}
\mathbf{O}^{(j,i)} = \mathbf{R}(\phi_{ij},\theta_{ij},0) \mathbf{O}^{(z)}(r_{ij}) \mathbf{R}(0,-\theta_{ij}, - \phi_{ij})
\end{equation}\]</span> for the irregular case, where <span class="math inline">\(\mathbf{O}^{(z)}(r_{ij})\)</span> represents the matrix of axial translation coefficients, many (how many?) of which are zero due to the special case of axial translation along <span class="math inline">\(z\)</span>. Note that the three aforementioned steps correspond to stepwise movement of the local axis, from the perspective of the initial point <span class="math inline">\(i\)</span>, and the transformation corresponds to reading the matrix multiplication in () from left to right; but the sequence of steps and the direction of movement is actually reversed from the perspective of the scatterer at the destination point. More importnantly, since all three matrix-factors on the right-hand side of () will contain many (how many?) zeroes, operating on a vector of VSW coefficients in a sequence of three steps can actually reduce the scaling of the net computational cost from <span class="math inline">\(\sim n_{\rm max}^{4}\)</span> to <span class="math inline">\(\sim n_{\rm max}^{3}\)</span>, when the na"ive matrix multiplication on each step is replaced by a custom operation that sums just over the relevant (non-zero) components. See Appendix~ for more details.</p>
<p>Another potential advantage of using () is that, after obtaining the three factors for <span class="math inline">\(\mathbf{O}^{(j,i)}\)</span>, they can be recycled when computing the reverse translation <span class="math inline">\(\mathbf{O}^{(i,j)}\)</span> to reduce the overall computational cost. First, beware that <span class="math inline">\(\mathbf{O}^{(z)}(-r_{ij})\)</span> is  the inverse of <span class="math inline">\(\mathbf{O}^{(z)}(r_{ij})\)</span>, and note that <span class="math inline">\(\mathbf{O}^{z}(r_{ij})\)</span> is invariant to interchanging <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> (<span class="math inline">\(r_{ij} = r_{ji} \geq 0\)</span>). Actually, <span class="math inline">\([\mathbf{O}^{(z)}(r_{ij})]^{-1} = \mathbf{R}(0,\pi,0) \mathbf{O}^{(z)}(r_{ij}) \mathbf{R}(0,-\pi,0)\)</span>, where <span class="math inline">\(\mathbf{R}(0,\pi,0)\)</span> is block-diagonal and each block is -diagonal. Second, since <span class="math inline">\(\phi_{ij} = \pi + \phi_{ji}\)</span> and <span class="math inline">\(\theta_{ij} = \pi - \theta_{ji}\)</span>, <span class="math inline">\(\mathbf{R}(\phi_{ji}, \theta_{ji},0)\)</span> can be calculated from <span class="math inline">\(\mathbf{R}(\phi_{ij}, \theta_{ij},0)\)</span> using the symmetry relation <span class="math inline">\(d_{\mu m}^{n}(\pi - \theta) = (-1)^{n-m}d_{-\mu m}^{n}(\theta)\)</span> (see eqn.~B.7 in ref.), so that <span class="math inline">\(D_{\mu m}^{n}(\phi_{ji},\theta_{ji},0) = (-1)^{n-m+1}D_{-\mu m}^{n}(\phi_{ij},\theta_{ij},0)\)</span>, where the extra prefactor of <span class="math inline">\(-1\)</span> comes from multiplying by <span class="math inline">\(e^{-i\pi} = -1\)</span>.</p>
<p>To conclude this section, we note that computing <span class="math inline">\(\mathbf{O}\)</span> in general is actually more costly than the combined effort of computing <span class="math inline">\(\mathbf{O}^{(z)}\)</span>, <span class="math inline">\(\mathbf{R}\)</span>,  <span class="math inline">\(\mathbf{R}^{-1}\)</span>. However, performing matrix multiplication of the three factors in the right sequence (<span class="math inline">\(\mathbf{R}\mathbf{O}^{(z)}\mathbf{R}^{-1}\)</span>) does not seem to produce the expected result (<span class="math inline">\(\mathbf{O}\)</span>), perhaps symptomatic of the numerical subtleties involved in the calculation of <span class="math inline">\(\mathbf{O}\)</span>.</p>
</div>
</div>
<div class="section level2">
<h2 id="multiple-scattering">Multiple scattering<a class="anchor" aria-label="anchor" href="#multiple-scattering"></a>
</h2>
<p>This section was written after first reading two papers by Stout_et al_~ and then three earlier papers by Mackowski_et al_~.</p>
<div class="section level3">
<h3 id="formulating-the-problem">Formulating the problem<a class="anchor" aria-label="anchor" href="#formulating-the-problem"></a>
</h3>
<p>For a cluster of <span class="math inline">\(N\)</span> individual scatterers (each of arbitrary shape), the collectively scattered field <span class="math inline">\(\mathbf{E}_{\rm sca}^{\rm cl}\)</span> can be separated into additive contributions from the individuals, i.e.: <span class="math display">\[\begin{equation}
\mathbf{E}_{\rm sca}^{\rm cl} (\mathbf{r}) = \sum\limits_{j=1}^{N} \mathbf{E}_{\rm sca}^{(j)}(\mathbf{r}) = E \sum\limits_{j=1}^{N} \mathbf{W}({\bf r}_{j}) \mathbf{c}_{\rm sca}^{(j)} \label{eqn:scaCoeffsJ}
\end{equation}\]</span> where <span class="math inline">\(\mathbf{r}_{j} = \mathbf{r}- \mathbf{x}_{j}\)</span>, <span class="math inline">\(\mathbf{x}_{j}\)</span> is the position of the <span class="math inline">\(j\)</span>th scatterer relative to a fixed origin <span class="math inline">\(\mathbf{x}_{0}\)</span>. It is important to stress that the VSW expansion for each <span class="math inline">\(\mathbf{E}_{\rm sca}^{(j)}(\mathbf{r})\)</span> in () is developed in terms of irregular waves centred at <span class="math inline">\(\mathbf{x}_{j}\)</span>, as indicated in the subscript of <span class="math inline">\(\mathbf{r}_{j}\)</span> and the superscript of the corresponding coefficients <span class="math inline">\(\mathbf{c}_{\rm sca}^{(j)}\)</span>. It is even more important to note that () does not actually prescribe how exactly the collective field is partitioned among the individuals.</p>
<p>It is useful to define the excitation field <span class="math inline">\(\widetilde{\mathbf{E}}_{\rm exc}^{(j)}(\mathbf{r})\)</span> for each scatterer <span class="math inline">\(j\)</span>, and then develop it in terms of regular VSWs centred at <span class="math inline">\(\mathbf{x}_{j}\)</span>, i.e. <span class="math display">\[\begin{eqnarray}
\widetilde{\mathbf{E}}_{\rm exc}^{(j)} (\mathbf{r}) &amp; \equiv &amp; \widetilde{\mathbf{E}}_\mathrm{inc}(\mathbf{r}) + \sum\limits_{\substack{l=1\\l \neq j}}^{N} \mathbf{E}_{\rm sca}^{(l)} (\mathbf{r}) \nonumber \\
&amp; = &amp; E \widetilde{\mathbf{W}}(\mathbf{r}) \widetilde{\mathbf{c}}_{\rm inc} + E \sum\limits_{\substack{l=1\\l\neq j}}^{N} \mathbf{W}(\mathbf{r}_{l}) \mathbf{c}_{\rm sca}^{(l)} \nonumber \\
&amp; = &amp; E \widetilde{\mathbf{W}}(\mathbf{r}_{j}) \left( \widetilde{\mathbf{c}}_{\rm inc}^{(j)} + \sum\limits_{\substack{l=1\\l\neq j}}^{N} \underbrace{\mathbf{O}^{(j,l)} \mathbf{c}_{\rm sca}^{(l)}}_{\widetilde{\mathbf{c}}^{(j\leftarrow l)}} \right) \quad \mathrm{for~} \|\mathbf{r}_{j}\| &lt; \min\|\mathbf{x}_{j} - \mathbf{x}_{l}\|\label{eqn:excE} \\
&amp; \equiv &amp; E \widetilde{\mathbf{W}}(\mathbf{r}_{j}) \widetilde{\mathbf{c}}_{\rm exc}^{(j)} \label{eqn:excCoeffsJ}
\end{eqnarray}\]</span> where <span class="math inline">\(\widetilde{\mathbf{c}}_{\rm inc}^{(j)} = \widetilde{\mathbf{O}}^{(j,0)} \widetilde{\mathbf{c}}_{\rm inc}\)</span> and <span class="math inline">\(\widetilde{\mathbf{O}}^{(j,0)} \equiv \widetilde{\mathbf{O}}(\mathbf{x}_{j} - \mathbf{x}_{0})\)</span>. In the last equality of (), <span class="math inline">\(\mathbf{W}(\mathbf{r}_{l})\)</span> is transformed into <span class="math inline">\(\widetilde{\mathbf{W}}(\mathbf{r}_{j})\)</span>, with the correponding coefficients given by <span class="math inline">\(\widetilde{\mathbf{c}}^{(j\leftarrow l)} = \mathbf{O}^{(j,l)} \mathbf{c}_{\rm sca}^{(l)}\)</span>, where the superscript <span class="math inline">\((j\leftarrow l)\)</span> specifies the scattered field partition of scatterer <span class="math inline">\(l\)</span> developed (as a regular VSW expansion) about particle <span class="math inline">\(j\)</span>. Note the application of translation-addition theorem clause that applies only inside the ball of radius <span class="math inline">\(r_{jl}\)</span> (for each <span class="math inline">\(l\neq j\)</span>) centred at <span class="math inline">\(\mathbf{x}_{j}\)</span>). This approach is valid only if the translation ball fully contains the target scatterer’s surface, where the BCs are supposed to be matched. While non-overlapping spherical scatters are always guaranteed to satisfy this condition, Fig.~ shows that spheroids with aspect ratio greater than <span class="math inline">\(2\)</span> can be problematic, because the t-ball can intersect the target scatterer’s surface if it is sufficiently close (yet still not overlapping). Note that Mackowski explicitly mentions this issue when discussing equations 5-8 in ref.~, but only in the context of spherical scatterers.</p>
<p>From linearity and imposition of appropriate boundary conditions, again, the excitation coefficients <span class="math inline">\(\widetilde{\mathbf{c}}^{(j)}_{\rm exc}\)</span> defined in () must be related to the corresponding scattering coefficients <span class="math inline">\(\mathbf{c}^{(j)}_{\rm sca}\)</span> via <span class="math display">\[\begin{equation}
\mathbf{c}_{\rm sca}^{(j)} \equiv \mathbf{T}_{1}^{(j)} \widetilde{\mathbf{c}}^{(j)}_{\rm exc}, \label{eqn:Tmat1}
\end{equation}\]</span> where the <span class="math inline">\(\mathbf{T}_{1}^{(j)}\)</span> are the one-body transfer matrices. Note that <span class="math inline">\(\widetilde{\mathbf{c}}^{(j)}_{\rm exc} = \widetilde{\mathbf{c}}_{\rm inc}\)</span> for an isolated (<span class="math inline">\(j=N=1\)</span>) scatterer at the origin; and if the scatterer is spherically symmetric then <span class="math inline">\(\mathbf{T}_{1}^{(1)}\)</span> is a diagonal matrix with Mie coefficients running along the diagonal. For non-spherical scatterers, it may also be helpful to rotate (as well as translate) the coordinates to achieve a favourable orientation. Anyway, from (), (), and () we obtain an equation expressed just in terms of the field coefficients: <span class="math display">\[\begin{equation} \label{eqn:FunMultiScat}
\widetilde{\mathbf{c}}^{(j)}_{\rm exc} =  \widetilde{\mathbf{c}}^{(j)}_{\rm inc} + \sum\limits_{\substack{i=1\\i\neq j}}^{N} \underbrace{\mathbf{O}^{(j,i)} \mathbf{T}_{1}^{(i)}}_{\mathbf{T}_{1}^{(j \leftarrow i)}} \widetilde{\mathbf{c}}^{(i)}_{\rm exc},
\end{equation}\]</span> which is what Stout_et al_ regard as “the fundamental multiple scattering equation” (eqn.~9 in ref.~). It is helpful to rewrite the linear system () in block-matrix form: <span class="math display">\[\begin{equation} \label{eqn:FunMultiScatMat}
\begin{bmatrix}
\mathbf{I}&amp;  -\mathbf{O}^{(1,2)} \mathbf{T}_{1}^{(2)} &amp; \cdots &amp; -\mathbf{O}^{(1,N)}\mathbf{T}_{1}^{(N)} \\
-\mathbf{O}^{(2,1)} \mathbf{T}_{1}^{(1)} &amp; \mathbf{I}&amp; \cdots &amp; -\mathbf{O}^{(2,N)} \mathbf{T}_{1}^{(N)} \\ 
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
-\mathbf{O}^{(N,1)} \mathbf{T}_{1}^{(1)} &amp; -\mathbf{O}^{(N,2)} \mathbf{T}_{1}^{(2)} &amp; \cdots &amp; \mathbf{I}
\end{bmatrix}
\begin{pmatrix}
\widetilde{\mathbf{c}}^{(1)}_{\rm exc} \\
\widetilde{\mathbf{c}}^{(2)}_{\rm exc} \\
\vdots \\
\widetilde{\mathbf{c}}^{(N)}_{\rm exc}
\end{pmatrix}
=
\begin{pmatrix}
\widetilde{\mathbf{c}}^{(1)}_{\rm inc} \\
\widetilde{\mathbf{c}}^{(2)}_{\rm inc} \\
\vdots \\
\widetilde{\mathbf{c}}^{(N)}_{\rm inc} \\
\end{pmatrix}.
\end{equation}\]</span> We can use () to substitute the excitation field coefficients for the scattered field coefficients and, assuming the one-body T-matrices are invertible, obtain <span class="math display">\[\begin{equation} \label{eqn:FunMultiScat2}
\left[\mathbf{T}_{1}^{(j)}\right] ^{-1}\mathbf{c}^{(j)}_{\rm sca} - \sum\limits_{\substack{i=1\\i\neq j}}^{N} \mathbf{O}^{(j,i)}  \mathbf{c}^{(i)}_{\rm sca}  = \widetilde{\mathbf{c}}^{(j)}_{\rm inc},
\end{equation}\]</span> <span class="math display">\[\begin{equation} \label{eqn:FunMultiScatMat2}
\begin{bmatrix}
\left[ \mathbf{T}_{1}^{(1)} \right]^{-1} &amp;  -\mathbf{O}^{(1,2)} &amp; \cdots &amp; -\mathbf{O}^{(1,N)} \\
-\mathbf{O}^{(2,1)} &amp; \left[ \mathbf{T}_{1}^{(2)}\right]^{-1} &amp; \cdots &amp; -\mathbf{O}^{(2,N)} \\ 
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
-\mathbf{O}^{(N,1)} &amp; -\mathbf{O}^{(N,2)} &amp; \cdots &amp; \left[ \mathbf{T}_{1}^{(N)}\right]^{-1}
\end{bmatrix}
\begin{pmatrix}
\mathbf{c}^{(1)}_{\rm sca} \\
\mathbf{c}^{(2)}_{\rm sca} \\
\vdots \\
\mathbf{c}^{(N)}_{\rm sca}
\end{pmatrix}
=
\begin{pmatrix}
\widetilde{\mathbf{c}}^{(1)}_{\rm inc} \\
\widetilde{\mathbf{c}}^{(2)}_{\rm inc} \\
\vdots \\
\widetilde{\mathbf{c}}^{(N)}_{\rm inc} \\
\end{pmatrix}.
\end{equation}\]</span> We can also rearrange the linear system into <span class="math display">\[\begin{equation} \label{eqn:FunMultiScat3}
\mathbf{c}^{(j)}_{\rm sca} -\mathbf{T}_{1}^{(j)} \sum\limits_{\substack{i=1\\i\neq j}}^{N} \mathbf{O}^{(j,i)}  \mathbf{c}^{(i)}_{\rm sca}  = \mathbf{T}_{1}^{(j)} \widetilde{\mathbf{c}}^{(j)}_{\rm inc},
\end{equation}\]</span> <span class="math display">\[\begin{equation} \label{eqn:FunMultiScatMat3}
\begin{bmatrix}
\mathbf{I}&amp;  -\mathbf{T}_{1}^{(1)} \mathbf{O}^{(1,2)} &amp; \cdots &amp; -\mathbf{T}_{N}^{(1)}\mathbf{O}^{(1,N)} \\
-\mathbf{T}_{1}^{(2)} \mathbf{O}^{(2,1)} &amp; \mathbf{I}&amp; \cdots &amp; -\mathbf{T}_{1}^{(2)}\mathbf{O}^{(2,N)}  \\ 
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
- \mathbf{T}_{1}^{(N)} \mathbf{O}^{(N,1)}  &amp; -\mathbf{T}_{1}^{(N)} \mathbf{O}^{(N,2)}  &amp; \cdots &amp; \mathbf{I}
\end{bmatrix}
\begin{pmatrix}
\mathbf{c}^{(1)}_{\rm sca} \\
\mathbf{c}^{(2)}_{\rm sca} \\
\vdots \\
\mathbf{c}^{(N)}_{\rm sca}
\end{pmatrix}
=
\begin{pmatrix}
\mathbf{T}_{1}^{(1)}\widetilde{\mathbf{c}}^{(1)}_{\rm inc} \\
\mathbf{T}_{1}^{(2)}\widetilde{\mathbf{c}}^{(2)}_{\rm inc} \\
\vdots \\
\mathbf{T}_{1}^{(3)}\widetilde{\mathbf{c}}^{(N)}_{\rm inc} \\
\end{pmatrix},
\end{equation}\]</span> which is equivalent to Mackowski’s eqn.~4 in ref.~. In Mackowski’s earlier papers, however, beware that the same “fundamental” equation (eqn.~13 in ref.~ and eqn.~3 in ref.~) has a plus sign instead of the minus, which may be entirely due to a dubious minus sign featuring in the incident field expansion (see eqn.~4 in ref.~). The dubious minus sign is absent in eqn.~2 of the more recent ref.~, and the subsequent eqn.~4 matches our equation (). Phew!</p>
<p>Note that (), (), and () are all in the form of a general matrix equation <span class="math inline">\(\mathbf{A}\mathbf{x}= \mathbf{y}\)</span>, which can be solved for the column vector <span class="math inline">\(\mathbf{x}\)</span> without necessarily inverting the matrix <span class="math inline">\(\mathbf{A}\)</span>. However, formal inversion facilitates definition of auxiliary <span class="math inline">\(T\)</span>-matrix constructions for multiple scatterers.</p>
</div>
<div class="section level3">
<h3 id="t-matrix-constructions-for-n-scatterers">T-matrix constructions for <span class="math inline">\(N\)</span> scatterers<a class="anchor" aria-label="anchor" href="#t-matrix-constructions-for-n-scatterers"></a>
</h3>
<p>The system of coupled matrix equations in () can be solved for <span class="math inline">\(\mathbf{f}^{(j)}\)</span> by inverting the matrix to obtain</p>
<p><span class="math display">\[\begin{equation}\label{eqn:scatCentTMat}
\mathbf{c}^{(j)}_{\rm sca} = \sum_{i=1}^{N} \mathbf{T}_{N}^{(j,i)} \widetilde{\mathbf{c}}^{(i)}_{\rm inc} = \underbrace{\left(\sum_{i=1}^{N} \mathbf{T}_{N}^{(j,i)} \widetilde{\mathbf{O}}^{(i,0)}\right)}_{\mathrm{Mackowski's}~ \mathbf{T}_{N}^{(j)}} \widetilde{\mathbf{c}}_{\rm inc} = \underbrace{\left(\sum_{i=1}^{N} \mathbf{T}_{N}^{(j,i)} \widetilde{\mathbf{O}}^{(i,j)}\right)}_{\mathrm{Stout's}~ \mathbf{T}_{N}^{(j)}} \widetilde{\mathbf{c}}^{(j)}_{\rm inc},
\end{equation}\]</span> where <span class="math inline">\(\mathbf{T}_{N}^{(j,i)}\)</span> represents pairwise <span class="math inline">\(N\)</span>-body T-matrices, arranged and defined as follows <span class="math display">\[\begin{eqnarray}
\left[\mathbf{T}_{N}^{(j,i)}\right] &amp; = &amp;
\begin{bmatrix}
\mathbf{T}_{N}^{(1,1)} &amp; \mathbf{T}_{N}^{(1,2)} &amp; \cdots &amp; \mathbf{T}_{N}^{(1,N)} \\
\mathbf{T}_{N}^{(2,1)} &amp; \mathbf{T}_{N}^{(2,2)} &amp;
\cdots &amp; \mathbf{T}_{N}^{(2,N)} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\mathbf{T}_{N}^{(N,1)} &amp; \mathbf{T}_{N}^{(N,2)} &amp; \cdots &amp; \mathbf{T}_{N}^{(N,N)}
\end{bmatrix}
 =
\begin{bmatrix}
\left[\mathbf{T}_{1}^{(1)}\right]^{-1} &amp;  -\mathbf{O}^{(1,2)} &amp; \cdots &amp; -\mathbf{O}^{(1,N)} \\
-\mathbf{O}^{(2,1)} &amp; \left[\mathbf{T}_{1}^{(2)}\right]^{-1} &amp; \cdots &amp; -\mathbf{O}^{(2,N)} \\ 
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
-\mathbf{O}^{(N,1)} &amp; -\mathbf{O}^{(N,2)} &amp; \cdots &amp; \left[\mathbf{T}_{1}^{(N)}\right]^{-1}
\end{bmatrix}^{-1} \label{eqn:TjiMatrixDefinition} \\
&amp; = &amp; 
\begin{bmatrix}
\mathbf{T}_{1}^{(1)} &amp;  0 &amp; \cdots &amp; 0 \\
0 &amp; \mathbf{T}_{1}^{(2)} &amp; \cdots &amp; 0 \\ 
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; \mathbf{T}_{1}^{(N)}
\end{bmatrix}
\begin{bmatrix}
\mathbf{I}&amp;  -\mathbf{O}^{(1,2)} \mathbf{T}_{1}^{(2)} &amp; \cdots &amp; -\mathbf{O}^{(1,N)} \mathbf{T}_{1}^{(N)} \\
-\mathbf{O}^{(2,1)}\mathbf{T}_{1}^{(1)} &amp; \mathbf{I}&amp; \cdots &amp; -\mathbf{O}^{(2,N)} \mathbf{T}_{1}^{(N)} \\ 
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
-\mathbf{O}^{(N,1)}\mathbf{T}_{1}^{(1)} &amp; -\mathbf{O}^{(N,2)} \mathbf{T}_{1}^{(2)} &amp; \cdots &amp; \mathbf{I}
\end{bmatrix}^{-1} \\
&amp; = &amp; 
\begin{bmatrix}
\mathbf{I}&amp;  - \mathbf{T}_{1}^{(1)} \mathbf{O}^{(1,2)} &amp; \cdots &amp; -\mathbf{T}_{1}^{(1)} \mathbf{O}^{(1,N)} \\
-\mathbf{T}_{1}^{(2)} \mathbf{O}^{(2,1)} &amp; \mathbf{I}&amp; \cdots &amp; -\mathbf{T}_{1}^{(2)} \mathbf{O}^{(2,N)} \\ 
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
-\mathbf{T}_{1}^{(N)} \mathbf{O}^{(N,1)} &amp; -\mathbf{T}_{1}^{(N)} \mathbf{O}^{(N,2)} &amp; \cdots &amp; \mathbf{I}
\end{bmatrix}^{-1}
\begin{bmatrix}
\mathbf{T}_{1}^{(1)} &amp;  0 &amp; \cdots &amp; 0 \\
0 &amp; \mathbf{T}_{1}^{(2)} &amp; \cdots &amp; 0 \\ 
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; \mathbf{T}_{1}^{(N)} \label{eqn:TjiMatrixFactored2}
\end{bmatrix}
\end{eqnarray}\]</span></p>
<p>with the last two lines merely showing how the one-body T-matrices can be factored out in two different ways (left or right). [Q: How to interpret <span class="math inline">\(\mathbf{O}^{(i,j)}\mathbf{T}_{1}^{(j)}\)</span> and <span class="math inline">\(\mathbf{T}_{1}^{(i)} \mathbf{O}^{(i,j)}\)</span>?]</p>
<p>The <span class="math inline">\(\mathbf{T}_{N}^{(j,i)}\)</span> matrices form a complete multiple-scattering solution of the <span class="math inline">\(N\)</span>-particle system. Stout <em>et al</em> calls these matrices “scatterer-centred tranfer matrices” (see eqn.~12 in ref.~), while Mackowski refers to them as “sphere-centred” (see eqn.~16 in ref.~ and eqn.~4 in ref.~). However, both terms seem equally applicable to <span class="math inline">\(\mathbf{T}_{N}^{(j)}\)</span>, which Mackowski defines one way (see eqn.~61 in ref.~) but does not give it a name, while Stout <em>et al</em> define <span class="math inline">\(\mathbf{T}_{N}^{(j)}\)</span> differently and call it “individual <span class="math inline">\(N\)</span>-body transfer matrices” (see eqns.~14 and 27 in ref.~). To avoid any possible confusion, we shall refer to <span class="math inline">\(\mathbf{T}_{N}^{(j,i)}\)</span> and Mackowski’s <span class="math inline">\(\mathbf{T}_{N}^{(j)}\)</span> as “pairwise” and “individual” <span class="math inline">\(N\)</span>-body T-matrices, respectively, and we stress that <span class="math inline">\(\mathbf{T}_{N}^{(j)}\)</span> differs from <span class="math inline">\(\mathbf{T}_{1}^{(j)}\)</span> in equation ().</p>
<p>Mackowski’s “contraction” of the index <span class="math inline">\(i\)</span> in <span class="math inline">\(\mathbf{T}_{N}^{(j,i)}\)</span> to obtain <span class="math inline">\(\mathbf{T}_{N}^{(j)}\)</span> essentially links the individually-centred scattering coefficients, <span class="math inline">\(\mathbf{f}^{(j)}\)</span>, with the incident field coefficients, <span class="math inline">\(\widetilde{\mathbf{a}}\)</span>, for the regular VSW expansion centred at the common origin <span class="math inline">\(\mathbf{x}_{0}\)</span>. Mackowski also considers the collective scattering coefficients <span class="math inline">\(\mathbf{f}^{(0)}\)</span> for the irregular VSW expansion about the common origin, i.e.</p>
<p><span class="math display">\[\begin{equation}
 \mathbf{E}_{\rm sca}^{\rm cl} (\mathbf{r}) = E \mathbf{W}(\mathbf{r}) \mathbf{c}^{(0)}_{\rm sca} = E \mathbf{W}(\mathbf{r}) \left(\sum\limits_{j=1}^{N} \widetilde{\mathbf{O}}^{(0,j)}\mathbf{c}^{(j)}_{\rm sca}\right),\quad \mathrm{for} \quad \|\mathbf{r}\| &gt; \max\|\mathbf{x}_{j}\|\label{eqn:fcl},
\end{equation}\]</span></p>
<p>where the second equality relies on a particular clause of the translation-addition theorem, which is valid only outside of the smallest circumscribing sphere (encompassing all <span class="math inline">\(N\)</span> scatterers) centred at <span class="math inline">\(\mathbf{x}_{0}\)</span>. From () and () we have</p>
<p><span class="math display">\[\begin{equation} \label{eqn:Tcl}
\mathbf{c}^{(0)}_{\rm sca} = \sum_{j=1}^{N} \widetilde{\mathbf{O}}^{(0,j)} \sum_{i=1}^{N} \mathbf{T}_{N}^{(j,i)} \widetilde{\mathbf{O}}^{(i,0)} \widetilde{\mathbf{c}}_{\rm inc}  = \sum_{j=1}^{N} \widetilde{\mathbf{O}}^{(0,j)} \mathbf{T}_{N}^{(j)} \widetilde{\mathbf{c}}_{\rm inc} \equiv \mathbf{T}^{(0)}_{N} \widetilde{\mathbf{c}}_{\rm inc},
\end{equation}\]</span></p>
<p>which is analogous to () and provides an explicit expression for the collective <span class="math inline">\(\mathbf{T}^{(0)}_{N}\)</span> in terms of the pairwise and (Mackowski’s) individual <span class="math inline">\(N\)</span>-body T-matrices:</p>
<p><span class="math display">\[\begin{equation}
\mathbf{T}^{(0)}_{N} = \sum_{j=1}^{N}\sum_{i=1}^{N} \widetilde{\mathbf{O}}^{(0,j)} \mathbf{T}_{N}^{(j,i)} \widetilde{\mathbf{O}}^{(i,0)} = \sum_{j=1}^{N} \widetilde{\mathbf{O}}^{(0,j)} \mathbf{T}_{N}^{(j)}
\end{equation}\]</span></p>
<p>which is equivalent to Mackowski’s “cluster-centred” T-matrix (see eqn.~19 in ref.~, eqn.~64 in ref.~, and eqn.~29 in ref.~). Again, it is worth reiterating that () is valid only outside of the cluster’s smallest circumscribing sphere centred at the common origin, and Mackowski explicitly acknowledges this fact in refs.~! I suspect this limitation is present in most other studies that utilise a collective T-matrix, such as ref.~</p>
</div>
<div class="section level3">
<h3 id="calculation-of-optical-cross-sections-and-activity">Calculation of optical cross-sections and activity<a class="anchor" aria-label="anchor" href="#calculation-of-optical-cross-sections-and-activity"></a>
</h3>
<p>The total energy transfer from an incident plane wave <span class="math inline">\(\mathbf{E}_{\rm inc}\)</span> into <span class="math inline">\(\mathbf{E}_{\rm sca}\)</span> and/or <span class="math inline">\(\mathbf{E}_{\rm int}\)</span> as a result of scattering can be quantified by the  cross-section, <span class="math inline">\(\sigma_{\rm ext}\)</span>, which in the current formalism can be calculated from the scatterer-centred coefficients, here for convenience denoted by <span class="math inline">\(\mathbf{f}^{(j)} = \mathbf{c}_{\rm sca}^{(j)}\)</span> and <span class="math inline">\(\mathbf{a}^{(j)} = \widetilde{\mathbf{c}}_{\rm inc}^{(j)}\)</span>, using</p>
<p><span class="math display">\[\begin{equation} \label{eqn:sigExt}
\sigma_{\rm ext} = -\frac{1}{k_{\rm med}^{2}} \Re \left\{ \sum_{j=1}^{N} \mathbf{a}^{(j)\dagger}\mathbf{f}^{(j)}\right\} = -\frac{1}{k_{\rm med}^{2}} \sum_{j=1}^{N}\sum_{q=1}^{2}\sum_{n=1}^{n_{\rm max}} \sum_{m=-n}^{n} \Re \left\{ a^{(j)*}_{qnm} f^{(j)}_{qnm} \right \} \equiv \sum_{j=1}^{N} \sigma_{\rm ext}^{(j)},
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\Re\{ \dots \}\)</span> indicates taking the real part of the quantity inside the braces, <span class="math inline">\(\mathbf{a}^{(j)\dagger}\)</span> is conjugate transpose of the column vector <span class="math inline">\(\mathbf{a}^{(j)}\)</span>, <span class="math inline">\(a^{(j)*}_{qnm}\)</span> is the conjugate of the vector component <span class="math inline">\(a^{(j)}_{qnm}\)</span>, and <span class="math inline">\(k_{\rm med}\)</span> is the (real-valued) wave number for the (non-absorbing) medium. Note that () is from eqn.~29 of ref.~, which follows from simplifying eqn.~43 of ref.~ and substituting into eqn.~42 (of same reference); but it apparently differs from eqn.~H.65 of ref.~, where the conjugation is swapped, nonetheless producing the same result since <span class="math inline">\(\Re\{ab^{*}\} = \Re\{ a^{*}b\}\)</span> for any complex numbers <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. Also note that <span class="math inline">\(\sigma_{\rm ext}\)</span> is separable into additive contributions from individual scatterers, i.e. <span class="math inline">\(\sigma_{\rm ext} = \sum_{j}\sigma_{\rm ext}^{(j)}\)</span>. Mackowski cites the optical theorem when stating analogous expressions for <span class="math inline">\(\sigma_{\rm ext}\)</span> in eqns.~23-26 of ref.~, missing the minus sign (because of an extra minus sign in Mackowski’s definition of incident field coefficients) and featuring an extra factor of <span class="math inline">\(4\pi\)</span> (due to different normalisation condition for the angular part of VSWs, which can be seen by comparing the <span class="math inline">\(E_{mn}\)</span> in eqn.~21 of ref.~ with the <span class="math inline">\(\gamma_{mn}\)</span> in eqn.~C.22 of ref.~). To spice things up, in Mackowski’s earlier paper the <span class="math inline">\(4\pi\)</span> is <span class="math inline">\(2\pi\)</span> in the extinction cross-section formula (eqn.~31 of ref.~), where the minus sign is also missing yet there is no extra minus sign in the definition of incident field coefficients to explain the discrepancy. In Mackowski’s latest paper, the <span class="math inline">\(4\pi\)</span> again becomes <span class="math inline">\(2\pi\)</span> in the extinction cross-section formula (eqn.~24 in ref.), which also includes the minus sign, consistent with the absence of the dubious minus sign in the definition of incident field coefficients. Note that Suryadharma and Rockstuhl seem to have the same “<span class="math inline">\(4\pi\)</span> and no minus sign” convention as in ref.~, and the comparison between eqns.~64-65 of ref.~ may offer an alternative explanation for this pervasive discrepancy.</p>
<p>The scattering cross-section for a given excitation, <span class="math inline">\(\sigma_{\rm sca}\)</span>, can be computed using <span class="math display">\[\begin{equation} \label{eqn:sigSca}
\sigma_{\rm sca} = \frac{1}{k_{\rm med}^2} \Re\left\{ \sum_{j=1}^{N} \sum_{i=1}^{N} \mathbf{f}^{(j)\dagger} \widetilde{\mathbf{O}}^{(j,i)} \mathbf{f}^{(i)} \right\} = \frac{1}{k_{\rm med}^2} \sum_{j=1}^{N} \sum_{i=1}^{N} \sum_{l=1}^{L} \sum_{l'=1}^{L}  \Re \left\{ f_{l}^{(j)*} \widetilde{O}_{ll'}^{(j,i)} f_{l'}^{(i)} \right\} \equiv \sum_{j=1}^{N} \sigma_{\rm sca}^{(j)},
\end{equation}\]</span></p>
<p>where the composite index <span class="math inline">\(l\)</span> defined in () has been used for brevity. Note that () is also from eqn.~29 of ref.~, which follows from substituting eqn.~45 of ref.~ into eqn.~42 (of same reference). It seems to differ by a factor of <span class="math inline">\(4\pi\)</span> from eqn.~35 of ref.~, but for single scatterer (<span class="math inline">\(N=1\)</span>) it does reduce to eqn.~H.64 of ref.~. My understanding is that () is derived by considering the outward radial component of the Poynting vector for the scatterer field and integrating it over the surface of a sphere enclosing all the scatterers.</p>
<p>The absorption cross-section, <span class="math inline">\(\sigma_{\rm abs}\)</span> can be deduced using conservation of energy: <span class="math display">\[\begin{equation}
\sigma_{\rm abs} = \sigma_{\rm ext} - \sigma_{\rm sca},
\end{equation}\]</span> or</p>
<p>Recall that <span class="math inline">\(\sigma_{\rm ext}\)</span>, <span class="math inline">\(\sigma_{\rm sca}\)</span>, and <span class="math inline">\(\sigma_{\rm abs}\)</span> are defined for a particular incident field direction. The corresponding orientationally averaged quantities are obtained by averaging over all possible orientations, producing <span class="math inline">\(\langle \sigma_{\rm ext}\rangle\)</span>, <span class="math inline">\(\langle \sigma_{\rm sca}\rangle\)</span> and <span class="math inline">\(\langle \sigma_{\rm abs}\rangle\)</span>.</p>
</div>
<div class="section level3">
<h3 id="convergence-truncation-and-error-propagation">Convergence, truncation, and error propagation<a class="anchor" aria-label="anchor" href="#convergence-truncation-and-error-propagation"></a>
</h3>
<p>The <span class="math inline">\(T\)</span>-matrix formalism is founded on the premise that everything converges below a finite multipole order <span class="math inline">\(n_{\rm max} &lt; \infty\)</span>, i.e.~the field coefficients and <span class="math inline">\(T\)</span>-matrix elements become negligible for <span class="math inline">\(n &gt; n_{\rm max}\)</span>. Hence, while the formalism (including the translation-addition theorem for VSWs) is exact only in the impractical limit of <span class="math inline">\(n\to\infty\)</span>, sufficiently accurate numerical results can be obtained with finite vectors and matrices truncated above <span class="math inline">\(n_{\rm max}\)</span>. The question is: what is the appropriate choice of <span class="math inline">\(n_{\rm max}\)</span> for a given system and given numerical scheme? Should one choose just one value of <span class="math inline">\(n_{\rm max}\)</span>, or multiple values, each used at a different stage of the scheme? How exactly does the truncation error propagate from stage to stage? Answering these questions requires some numerical analysis and convergence testing…</p>
<ul>
<li>What is the most appropriate convergence criterion for the scatterer-centred one-body <span class="math inline">\(T\)</span>-matrices <span class="math inline">\(\mathbf{T}_{1}^{(i)}\)</span>, and when is convergence most problematic (i.e.~for the shortest wavelength in the given range, or the most “resonant” wavelength)?</li>
<li>What is the effect of truncation on the matrix products <span class="math inline">\(\mathbf{T}_{1}^{(i)} \mathbf{O}^{(i,j)}\)</span>, <span class="math inline">\(\mathbf{O}^{(j,i)} \mathbf{T}_{1}^{(i)}\)</span>, <span class="math inline">\(\mathbf{T}_{1}^{(i)} \widetilde{\mathbf{O}}^{(i,j)}\)</span>, and <span class="math inline">\(\widetilde{\mathbf{O}}^{(j,i)} \mathbf{T}_{1}^{(i)}\)</span>? That is, if these products do converge at some <span class="math inline">\(n_{\rm max}\)</span>, do we need to include higher orders (<span class="math inline">\(n &gt; n_{\rm max}\)</span>) in <span class="math inline">\(\mathbf{T}_{1}^{(i)}\)</span>? I suspect this may be the case for irregular VTACs (<span class="math inline">\(\mathbf{O}\)</span>), because their magnitude actually increases with <span class="math inline">\(n\)</span>; but not for regular ones, which diminish with increasing <span class="math inline">\(n\)</span>.</li>
<li>Numerical solution schemes described in the following section involve inverting large (<span class="math inline">\(N\)</span>-body) matrices composed of block of the form <span class="math inline">\(\mathbf{T}_{1}^{(i)} \mathbf{O}^{(i,j)}\)</span>, <span class="math inline">\(\mathbf{O}^{(j,i)} \mathbf{T}_{1}^{(i)}\)</span>, <span class="math inline">\(\mathbf{O}^{(i,j)}\)</span>, or <span class="math inline">\([\mathbf{T}_{1}^{(i)}]^{-1}\)</span>. However, there is no clear understanding of how the truncation error of each component affects the convergence of the <span class="math inline">\(N\)</span>-body matrix inversion.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="solution-schemes">Solution schemes<a class="anchor" aria-label="anchor" href="#solution-schemes"></a>
</h2>
<p>To “solve” a multiple scattering problem can mean different things. Usually it means to determine the scattering coefficients <span class="math inline">\(\mathbf{c}^{(j)}_{\rm sca}\)</span> for a given individual scatterer properties (described by <span class="math inline">\(\mathbf{T}_{1}^{(j)}\)</span>) and an excitation field (described by <span class="math inline">\(\widetilde{\mathbf{c}}^{(j)}_{\rm inc}\)</span>) impinging from a particular direction. This kind of “solution” can be achieved by solving the linear system of equations in () for <span class="math inline">\(\mathbf{a}^{(j)}_{\rm sca}\)</span>  performing matrix inversion, thus producing a complete description of the scattered field for the given excitation. The linear system would have to be solved again (entirely from scratch) for a different excitation. Performing the matrix inversion to determine the <span class="math inline">\(N\)</span>-body T-matrices becomes worthwhile only when many impinging directions are to be considered, or when rotationally-averaged quantities are of primary interest.</p>
<p>A brute force approach to solving the multiple scattering problem would be to construct the <span class="math inline">\(NL \times NL\)</span> matrix in equation () and then invert it to obtain the pairwise matrices <span class="math inline">\(\mathbf{T}^{(i,j)}\)</span>. However, this approach is computationally demanding. To help alleviate the cost of one large matrix inversion, Stout_et al_ proposed a recursive scheme where a smaller (<span class="math inline">\(L \times L\)</span>) matrix is inverted <span class="math inline">\(N-1\)</span> times.</p>
<div class="section level3">
<h3 id="stouts-recursive-scheme-with-matrix-balancing">Stout’s recursive scheme with matrix balancing<a class="anchor" aria-label="anchor" href="#stouts-recursive-scheme-with-matrix-balancing"></a>
</h3>
<p>In the recursive algorithm described by Stout_et al_, the elements of <span class="math inline">\(\mathbf{T}_{N}^{(j,i)}\)</span> are accumulated recursively from auxiliary subsystems, incrementally built up from one to <span class="math inline">\(N\)</span> particles. The recursive system is prescribed by the following four equation: <span class="math display">\[\begin{eqnarray}
\mathbf{T}_{N}^{(N,N)} &amp; = &amp; \left[ \left[\mathbf{T}_{1}^{(N)}\right]^{-1} - \sum_{j=1}^{N-1} \mathbf{O}^{(N,j)} \left( \underline{ \sum_{i=1}^{N-1} \mathbf{T}_{N-1}^{(j,i)} \mathbf{O}^{(i,N)} } \right) \right]^{-1} \equiv \mathbf{S}^{-1}, \label{eqn:TNNN} \\
\mathbf{T}_{N}^{(N,i)} &amp; = &amp; \mathbf{T}_{N}^{(N,N)} \left( \sum_{j=1}^{N-1} \mathbf{O}^{(N,j)} \mathbf{T}_{N-1}^{(j,i)} \right), \quad i\neq N,\\
\mathbf{T}_{N}^{(j,N)} &amp; = &amp; \left( \underline{ \sum_{i=1}^{N-1} \mathbf{T}_{N-1}^{(j,i)} \mathbf{O}^{(i,N)} } \right) \mathbf{T}_{N}^{(N,N)}, \quad j\neq N,\\
\mathbf{T}_{N}^{(j,i)} &amp; = &amp; \mathbf{T}_{N-1}^{(j,i)} + \left( \underline{ \sum_{l=1}^{N-1} \mathbf{T}_{N-1}^{(j,l)} \mathbf{O}^{(l,N)} } \right) \mathbf{T}_{N}^{(N,i)}, \quad j,i\neq N, 
\end{eqnarray}\]</span> where a common matrix sum has been underlined. Note that only one <span class="math inline">\(L\times L\)</span> matrix is inverted on each of the <span class="math inline">\(N-1\)</span> iterations. The inverted matrix becomes ill-conditioned for large <span class="math inline">\(n_{\rm max}\)</span>, but the associated problems can be (at least partly) circumvented by applying the recursive scheme to appropriately “balanced” matrices and coefficients: <span class="math display">\[\begin{eqnarray*}
\left[ \widehat{\mathbf{T}}_{N}^{(j,i)} \right]_{qp,q'p'} &amp; \equiv &amp; \left[ \mathbf{D}^{(j)} \mathbf{T}_{N}^{(j,i)} [\widetilde{\mathbf{D}}^{(i)}]^{-1} \right]_{qp,q'p'} =  \frac{\xi_{n(p)}(k_{\rm M}R_{j})}{\psi_{n'(p')}(k_{\rm M}R_{i})} \left[ \mathbf{T}_{N}^{(j,i)} \right]_{qp,q'p'}  \\
\left[ \widehat{\mathbf{T}}_{1}^{(j)} \right]_{qp,q'p'} &amp; \equiv &amp; \left[ \mathbf{D}^{(j)} \mathbf{T}_{1}^{(j)} [\widetilde{\mathbf{D}}^{(j)}]^{-1} \right]_{qp,q'p'} =  \frac{\xi_{n(p)}(k_{\rm M}R_{j})}{\psi_{n'(p')}(k_{\rm M}R_{j})} \left[ \mathbf{T}_{1}^{(j)} \right]_{qp,q'p'} \\
\left[ \widehat{\mathbf{O}}^{(j,i)} \right]_{qp,q'p'} &amp; \equiv &amp; \left[ \widetilde{\mathbf{D}}^{(j)} \mathbf{O}^{(j,i)} [\mathbf{D}^{(i)}]^{-1} \right]_{qp,q'p'} = \frac{\psi_{n(p)}(k_{\rm M}R_{j})}{\xi_{n'(p')}(k_{\rm M}R_{i})} \left[ \mathbf{O}^{(j,i)} \right]_{qp,q'p'},
\end{eqnarray*}\]</span> where <span class="math inline">\(\widetilde{\mathbf{D}}^{(j)}\)</span> and <span class="math inline">\(\mathbf{D}^{(j)}\)</span> are regular and irregular diagonal matrices with the Riccati-Bessel functions <span class="math inline">\(\psi_{n}(x) = x j_{n}(x)\)</span> or <span class="math inline">\(\xi_{n}(x) = x h_{n}(x)\)</span> on the diagonal. (Here, <span class="math inline">\(j_{n}(x)\)</span> and <span class="math inline">\(h_{n}(x)\)</span> are, respectively, the spherical Bessel and Hankel functions of the first kind). Note that, what Stout_et al_~ call “matrix balancing” could also be described as “left and right preconditioning”, because a matrix to be inverted is essentially left- and right-multiplied (i.e.~preconditioned) by two different matrices to improve its condition number, which is supposed to make numerical inversion more robust and accurate. Instead of balancing throughout, as Stout_et al_~ seem to do, it may be better to localise the balancing act just at the inversion step in (), i.e. <span class="math display">\[\begin{eqnarray*}
\mathbf{T}_{N}^{(N,N)} = \mathbf{S}^{-1} &amp; = &amp; \left[ \mathbf{D}^{(N)} \right]^{-1} \mathbf{D}^{(N)} \mathbf{S}^{-1} \left[ \widetilde{\mathbf{D}}^{(N)} \right] ^{-1}\widetilde{\mathbf{D}}^{(N)} \\
&amp; = &amp; \left[ \mathbf{D}^{(N)} \right]^{-1} \left[ \widetilde{\mathbf{D}}^{(N)} \mathbf{S} \left[ \mathbf{D}^{(N)} \right]^{-1} \right]^{-1}\widetilde{\mathbf{D}}^{(N)} \equiv \left[ \mathbf{D}^{(N)} \right]^{-1}  \widehat{\mathbf{S}}^{-1} \widetilde{\mathbf{D}}^{(N)} 
\end{eqnarray*}\]</span> where <span class="math inline">\(\widehat{\mathbf{S}}\)</span> is obtained by balancing <span class="math inline">\(\mathbf{S}\)</span> analogously to <span class="math inline">\(\widehat{\mathbf{H}}^{(j,i)}\)</span>.</p>
<p>Note that equation () can be factored in two ways: <span class="math display">\[\begin{eqnarray} \label{eqn:TNNN2}
\mathbf{T}_{N}^{(N,N)} &amp; = &amp; \mathbf{T}_{1}^{(N)} \left[ \mathbf{I}- \sum_{j=1}^{N-1} \mathbf{O}^{(N,j)} \left( \underline{ \sum_{i=1}^{N-1} \mathbf{T}_{N-1}^{(j,i)} \mathbf{O}^{(i,N)} } \right) \mathbf{T}_{1}^{(N)} \right]^{-1} \quad \equiv \quad \mathbf{T}_{1}^{(N)} \mathbf{S}^{-1}_{R}\\
&amp; = &amp; \left[ \mathbf{I}- \mathbf{T}_{1}^{(N)} \sum_{j=1}^{N-1} \mathbf{O}^{(N,j)} \left( \underline{ \sum_{i=1}^{N-1} \mathbf{T}_{N-1}^{(j,i)} \mathbf{O}^{(i,N)} } \right) \right]^{-1} \mathbf{T}_{1}^{(N)} \quad \equiv \quad \mathbf{S}^{-1}_{L} \mathbf{T}_{1}^{(N)} ,
\end{eqnarray}\]</span> either of which may be preferred if <span class="math inline">\(\mathbf{T}_{1}^{(N)}\)</span> is difficult to invert. To facilitate the inversion of <span class="math inline">\(\mathbf{S}_{L}\)</span> and <span class="math inline">\(\mathbf{S}_{R}\)</span>, slightly different balancing (and subsequent unbalancing) should be used: <span class="math display">\[\begin{eqnarray}
\mathbf{S}_{L}^{-1} = \left[\mathbf{D}_{N}^{(N)}\right]^{-1} \left[ \mathbf{D}_{N}^{(N)} \mathbf{S}_{L} \left[\mathbf{D}_{N}^{(N)}\right]^{-1} \right]^{-1} \mathbf{D}_{N}^{(N)} \equiv \left[\mathbf{D}_{N}^{(N)}\right]^{-1} \widehat{\mathbf{S}}_{L}^{-1} \mathbf{D}_{N}^{(N)}, \\
\mathbf{S}_{R}^{-1} =  \widetilde{\mathbf{D}}_{N}^{(N)} \left[ \left[\widetilde{\mathbf{D}}_{N}^{(N)}\right]^{-1} \mathbf{S}_{R} \widetilde{\mathbf{D}}_{N}^{(N)} \right]^{-1} \left[\widetilde{\mathbf{D}}_{N}^{(N)}\right]^{-1}  \equiv \widetilde{\mathbf{D}}_{N}^{(N)}  \widehat{\mathbf{S}}_{R}^{-1} \left[\widetilde{\mathbf{D}}_{N}^{(N)}\right]^{-1}.
\end{eqnarray}\]</span> Here <span class="math inline">\(\mathbf{S}_{L}\)</span> is balanced like irregular VTACs (or the inverse of a <span class="math inline">\(T\)</span>-matrix) using only irregular weights, while <span class="math inline">\(\mathbf{S}_{R}\)</span> is balanced like a <span class="math inline">\(T\)</span>-matrix using only regular weights. In my experience, <span class="math inline">\(\widehat{\mathbf{S}}_{R}\)</span> is much better conditioned for inversion than <span class="math inline">\(\widehat{\mathbf{S}}\)</span>, and I haven’t compared with <span class="math inline">\(\widehat{\mathbf{S}}_{L}\)</span>.</p>
</div>
<div class="section level3">
<h3 id="mackowski-and-mishchenkos-scheme">Mackowski and Mishchenko’s scheme<a class="anchor" aria-label="anchor" href="#mackowski-and-mishchenkos-scheme"></a>
</h3>
<p>From the equations () and () it follows that <span class="math display">\[\begin{equation}
\begin{bmatrix}
\mathbf{I}&amp; \cdots &amp; - \mathbf{T}_{1}^{(1)} \mathbf{O}^{(1,N)} \\
\vdots &amp; \ddots &amp; \vdots \\
- \mathbf{T}_{1}^{(N)} \mathbf{O}^{(N,1)} &amp; \cdots &amp; \mathbf{I}
\end{bmatrix}
\begin{bmatrix}
\mathbf{T}_{N}^{(1,1)} &amp; \cdots &amp; \mathbf{T}_{N}^{(1,N)} \\
\vdots &amp; \ddots &amp; \vdots \\
\mathbf{T}_{N}^{(N,1)} &amp; \cdots &amp; \mathbf{T}_{N}^{(N,N)}
\end{bmatrix}
=
\begin{bmatrix}
\mathbf{T}_{1}^{(1)} &amp; \cdots &amp; 0 \\
\vdots &amp; \ddots &amp; \vdots \\
0 &amp; \cdots &amp; \mathbf{T}_{1}^{(N)}
\end{bmatrix},
\end{equation}\]</span> or, equivalently, <span class="math display">\[\begin{equation}
\mathbf{T}_{N}^{(i,i)} - \sum_{j\neq i}\mathbf{T}_{1}^{(i)} \mathbf{O}^{(i,j)}\mathbf{T}_{N}^{(j,i)} = \mathbf{T}_{1}^{(i)},
\end{equation}\]</span> which is a linear system of the general form <span class="math inline">\(\mathbf{A}\mathbf{X} = \mathbf{B}\)</span>, where we want to find matrix <span class="math inline">\(\mathbf{X}\)</span> for a given <span class="math inline">\(\mathbf{A}\)</span> and <span class="math inline">\(\mathbf{B}\)</span>, which contains multiple right hand sides. That is, each column of <span class="math inline">\(\mathbf{X}\)</span> and <span class="math inline">\(\mathbf{B}\)</span> can be treated independently, so we have to solve many linear systems of the form <span class="math inline">\(\mathbf{A}\mathbf{x}_{\nu} = \mathbf{b}_{\nu}\)</span>, where <span class="math inline">\(\mathbf{x}_{\nu}\)</span> and <span class="math inline">\(\mathbf{b}_{\nu}\)</span> are the <span class="math inline">\(\nu\)</span>’th column of <span class="math inline">\(\mathbf{X}\)</span> and <span class="math inline">\(\mathbf{B}\)</span>, respectively. This approach suggests that matrix inversion should be more difficult than solving a linear system, because the inversion actually requires solving many linear systems…]</p>
<p>Mackowski and Mishchenko (M{&amp;}M) “contract” the second particle index of <span class="math inline">\(\mathbf{T}_{N}^{(j,i)}\)</span>, using <span class="math inline">\(\mathbf{T}_{N}^{(j)} = \sum_{i} \mathbf{T}_{N}^{(j,i)} \widetilde{\mathbf{O}}^{(i,0)}\)</span>, to rewrite the linear system in terms of  (as opposed to pairwise) scatterer-centred T-matrices <span class="math inline">\(\mathbf{T}_{N}^{(j)}\)</span>, i.e. <span class="math display">\[\begin{equation} \label{eqn:Mackowski}
\begin{bmatrix}
\mathbf{I}&amp; \cdots &amp; - \mathbf{T}_{1}^{(1)} \mathbf{O}^{(1,N)} \\
\vdots &amp; \ddots &amp; \vdots \\
- \mathbf{T}_{1}^{(N)} \mathbf{O}^{(N,1)} &amp; \cdots &amp; \mathbf{I}
\end{bmatrix}
\begin{pmatrix}
\mathbf{T}_{N}^{(1)} \\
\vdots \\
\mathbf{T}_{N}^{(N)}
\end{pmatrix}
=
\begin{pmatrix}
\mathbf{T}_{1}^{(1)} \widetilde{\mathbf{O}}^{(1,0)} \\
\vdots \\
\mathbf{T}_{1}^{(N)} \widetilde{\mathbf{O}}^{(N,0)}
\end{pmatrix},
\end{equation}\]</span> or, equivalently, <span class="math display">\[\begin{equation}
\mathbf{T}_{N}^{(i)} - \sum_{j\neq i}\mathbf{T}_{1}^{(i)} \mathbf{O}^{(i,j)}\mathbf{T}_{N}^{(j)} = \mathbf{T}_{1}^{(i)} \widetilde{\mathbf{O}}^{(i,0)},
\end{equation}\]</span></p>
<p>where the number of independent linear systems of the form <span class="math inline">\(\mathbf{A}\mathbf{x}_{\nu} = \mathbf{b}_{\nu}\)</span> is now reduced. [Does this index contraction affect the “optimal” choice of <span class="math inline">\(n_{\rm max}\)</span>?] M{&amp;}M claim to use (bi)conjugate gradient method to solve <span class="math inline">\(\mathbf{A}\mathbf{x}_{\nu} = \mathbf{b}_{\nu}\)</span> for each <span class="math inline">\(\nu\)</span>, where the row order (i.e.~length of each column vector) is predetermined using Lorentz/Mie theory result for each (spherical) scatterer in isolation, and the truncation limit for the column order (i.e.~the maximum value of <span class="math inline">\(\nu\)</span>) is determined on-the-fly from the convergence of each scatterer’s contribution to the collective rotationally-veraged extinction cross-section (see eqn.~66 in ref.~).</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Dmitri Schebarchov, Atefeh Fazel-Najafabadi, Eric Le Ru, Baptiste Auguié.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
