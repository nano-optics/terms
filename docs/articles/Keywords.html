<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Keywords • terms</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Keywords">
<meta property="og:description" content="terms">
<meta property="og:image" content="http://nano-optics.ac.nz/terms/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><link rel="stylesheet" type="text/css" href="http://www.x3dom.org/x3dom/src/x3dom.css">
<script type="text/javascript" src="http://www.x3dom.org/x3dom/src/x3dom.js"></script><style>
.x3d_scene {
  max-width: 300px;
    width: 80%;
    height: 80%;
    margin: 1em;
    background: rgb(238,251,255);
    background: radial-gradient(circle, rgba(238,251,255,1) 0%, rgba(212,212,212,1) 100%);
 }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">terms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/Keywords.html">Keywords</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Simple examples</li>
    <li>
      <a href="../articles/01_dimer_spheres/01_dimer_spheres.html">01 dimer spheres</a>
    </li>
    <li>
      <a href="../articles/02_angular_dispersion/02_angular_dispersion.html">02 angular dispersion</a>
    </li>
    <li>
      <a href="../articles/03_nearfield_coreshells/03_nearfield_coreshells.html">03 nearfield coreshells</a>
    </li>
    <li>
      <a href="../articles/04_chiral_dimer_spheroids/04_chiral_dimer_spheroids.html">04 chiral dimer spheroids</a>
    </li>
    <li>
      <a href="../articles/05_quadrature_averaging/05_quadrature_averaging.html">05 quadrature averaging</a>
    </li>
    <li>
      <a href="../articles/06_dielectric_function/06_dielectric_function.html">06 dielectric function</a>
    </li>
    <li>
      <a href="../articles/07_ldoc/07_ldoc.html">07 local degree of chirality</a>
    </li>
    <li>
      <a href="../articles/08_polarimetry/08_polarimetry.html">08 polarimetry</a>
    </li>
    <li>
      <a href="../articles/09_spectrum_near_field/09_spectrum_near_field.html">09 orientation-averaged near field spectrum</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Advanced examples &amp; testing</li>
    <li>
      <a href="../articles/10_shell_absorption/10_shell_absorption.html">10 shell absorption</a>
    </li>
    <li>
      <a href="../articles/11_convergence/11_convergence.html">11 convergence</a>
    </li>
    <li>
      <a href="../articles/12_convergence_VTACS/12_convergence_VTACS.html">12 convergence VTACS</a>
    </li>
    <li>
      <a href="../articles/13_masking/13_masking.html">13 masking</a>
    </li>
    <li>
      <a href="../articles/14_diffractive_chain/14_diffractive_chain.html">14 diffractive chain</a>
    </li>
    <li>
      <a href="../articles/15_quadrimer/15_quadrimer.html">15 quadrimer vs 2 dimers</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Technical notes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Convergence and timing studies</li>
    <li>
      <a href="../articles/101_timing/101_timing.html">101 timing</a>
    </li>
    <li>
      <a href="../articles/102_comparison_schemes/102_comparison_schemes.html">102 comparison of schemes</a>
    </li>
    <li>
      <a href="../articles/104_large_separation/104_large_separation.html">104 large separation</a>
    </li>
    <li>
      <a href="../articles/105_factorised_RTR/105_factorised_RTR.html">105 factorised RTR</a>
    </li>
    <li>
      <a href="../articles/106_balancing/106_balancing.html">106 balancing</a>
    </li>
    <li>
      <a href="../articles/109_individual_absorption/109_individual_absorption.html">109 individual absorption</a>
    </li>
    <li>
      <a href="../articles/110_alpha_tensor/110_alpha_tensor.html">110 alpha tensor</a>
    </li>
    <li>
      <a href="../articles/111_polarised_nf/111_polarised_nf.html">111 polarised OA near-fields</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Validation</li>
    <li>
      <a href="../articles/1001_mstm_ff/1001_mstm_ff.html">1001 MSTM far-field</a>
    </li>
    <li>
      <a href="../articles/1003_cda/1003_cda.html">1003 CDA dichroism</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../articles/Indexing.html">Indexing conventions</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nano-optics/terms/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Keywords</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nano-optics/terms/blob/HEAD/vignettes/Keywords.Rmd" class="external-link"><code>vignettes/Keywords.Rmd</code></a></small>
      <div class="hidden name"><code>Keywords.Rmd</code></div>

    </div>

    
    
<p>List of (case sensitive!) keywords and corresponding arguments supported by <strong>TERMS</strong>. Optional arguments are enclosed in square brackets (nested in some cases).</p>
<div class="section level2">
<h2 id="main-input-parameters">Main input parameters<a class="anchor" aria-label="anchor" href="#main-input-parameters"></a>
</h2>
<div class="section level3">
<h3 id="modeandscheme-m-s">ModeAndScheme <em>M</em> <em>S</em><a class="anchor" aria-label="anchor" href="#modeandscheme-m-s"></a>
</h3>
<p>If present, this keyword must appear first in the input file. It takes two arguments: positive integer <em>M</em> specifying the desired calculation mode; and non-negative integer <em>S</em> specifying the solution scheme to be used. The default values are <em>M</em> = 2 and <em>S</em> = 3.</p>
<p><strong>Mode of calculation</strong></p>
<ul>
<li>
<em>M = 1</em> triggers a single- or multi-wavelength calculation of near fields <span class="math inline">\(\mathbf{E}\)</span>, <span class="math inline">\(\mathbf{B}\)</span> and optical chirality <span class="math inline">\(\mathscr{C}\)</span>, at fixed incidence directions and/or orientation-averaged</li>
<li>
<em>M = 2</em> triggers a single- or multi-wavelength calculation of far-field properties (e.g. spectra of optical cross-sections), at fixed incidence directions and/or orientation-averaged</li>
<li>
<em>M = 3</em> triggers a single- or multi-wavelength calculation of polarimetric properties, such as Stokes scattering vectors, phase matrix, and differential scattering cross sections for multiple incidence and/or scattering angles</li>
</ul>
<p><strong>Scheme of solution</strong></p>
<ul>
<li>
<em>S = 0</em> will seek solutions for the given angles of incidence, without seeking the collective <em>T</em>-matrix</li>
<li>
<em>S &gt; 0</em> will calculate the collective <em>T</em>-matrix either (<em>S = 1</em>) by direct inversion of the complete linear system to obtain <span class="math inline">\(T^{(i,j)}\)</span>, or (<em>S = 2</em>) by using Stout’s iterative scheme for <span class="math inline">\(T^{(i,j)}\)</span>, or (<em>S = 3</em>) by using Mackowski’s scheme for <span class="math inline">\(T^{(i)}\)</span>. Note that fixed-orientation cross-sections are also calculated when <span class="math inline">\(S &gt; 0\)</span>.</li>
</ul>
</div>
<div class="section level3">
<h3 id="scatterers-n">Scatterers <em>N</em><a class="anchor" aria-label="anchor" href="#scatterers-n"></a>
</h3>
<p>This keyword must appear last in the <code>inputfile</code>, with a single positive integer argument <em>N</em> specifying the number of scatterers. The following <em>N</em> lines specify all the required parameters per scatterer, and each line must contain five or more space-separated fields, i.e.</p>
<pre><code>Tag x y z R [ a b c [ d ] ]     ( if Tag(1:2)  = "TF" )   
            [ a [ b [ c ] ] ]   ( if Tag(1:2) != "TF" )</code></pre>
<p>where <em>Tag</em> is a contiguous string, which may contain one underscore to separate the root from the suffix; <em>x</em>, <em>y</em>, <em>z</em> are the Cartesian coordinates (in the lab frame) for the scatterer, whose smallest circumscribing sphere has radius <em>R</em>. All other subsequent parameters (inside square brackets) depend on the root of <em>Tag</em> .</p>
<p>Before the root of <em>Tag</em> is parsed, the code first looks for a suffix of the form <em>_S?</em> and associates it with a multipole selection predefined using the <a href="#MultipoleSelections"><code>MultipoleSelections</code></a> keyword.</p>
<p>If the root of <em>Tag</em> is either “TF1”, “TF2”, … , or “TF9”, which correspond to a 1-body <em>T</em>-matrix file listed under the <a href="#TmatrixFiles"><code>TmatrixFiles</code></a> keyword, floats <em>a</em>, <em>b</em>, and <em>c</em> can be supplied to specify the Euler angles describing the scatterer orientation (default angle values are all zero). Another float <em>d</em> may be included to specify the aspect ratio for spheroids, which is currently only used for mapping local field intensity and visualising the geometry. Note that <em>d</em> is interpreted as the ratio of polar (along z) to equatorial (along x or y) length, so that <em>d &gt; 1</em> for prolate spheroids, <em>d &lt; 1</em> for oblate spheroids, and <em>d = 1</em> for spheres (default). Note that for nonspherical particles the circumscribing sphere radius <em>R</em> is used to check for potential geometrical overlap between particles, but also in the balancing scheme.</p>
<p>If the root of <em>Tag</em> is not “TF?”, the 1-body <em>T</em>-matrix is computed using Mie theory, which is applicable to coated spheres. The expected <em>Tag</em> format is <code>L0@L1@L2@L3</code>, with the character “@” delimiting substrings that specify the material dielectric function of each concentric region inside the scatterer, starting from the core (<em>L0</em>) and going <em>outward</em>. The number of coats is inferred from the number of instances of “@” and is currently capped at 3. <em>Tag</em> of a homogeneous sphere (without layers) should not contain any “@”, i.e. <em>Tag = L0</em>. Currently accepted values for <em>L?</em> are: “Au”, “Ag”, “Al”, “Cr”, “Pt”, “Pd”, “Si”, and “Water” which trigger internal calculation of the wavelength-dependent dielectric functions for the required material, or “DF1”, “DF2”, …, “DF9” to impose a custom dielectric function listed under the <a href="#dielectricfunctions-nfuns-1"><code>DielectricFunctions</code></a> keyword. For coated spheres, the outer radius of each region must be specified by floats <em>R</em>, <em>a</em>, <em>b</em>, <em>c</em> in the order of decreasing size (i.e. going radially <em>inward</em>).</p>
</div>
<div class="section level3">
<h3 id="tmatrixfiles-nfiles">TmatrixFiles <em>N<sub>files</sub></em><a class="anchor" aria-label="anchor" href="#tmatrixfiles-nfiles"></a>
</h3>
<p>Specifies the number of external <em>T</em>-matrix files (default: <em>N<sub>files</sub> = 0</em>). The subsequent <em>N<sub>files</sub></em> lines are each read as a string and then interpreted as a filename. Wrap the string in quotation marks if it contains the relative path or special characters, e.g. <code>"../../tmatrix_Au_spheroid_50x20_water.tmat"</code>. Note that the wavelengths in each file must <em>exactly</em> correspond to the values specified by the <a href="#wavelength-l1-l2-n-"><code>Wavelength</code></a> keyword.</p>
<p>The <em>T</em>-matrix file format is as follows:</p>
<ul>
<li>First line is a comment (starts with a <code>#</code>) describing the format <code># s sp n np m mp Tr Ti</code>
</li>
<li>Second line is also a comment and starts with <code># lambda= N1 nelements= N2</code> where N1 is the wavelength in nanometres, and N2 is the number of <em>T</em>-matrix elements to be read below</li>
<li>Subsequent lines contain the indices and <em>T</em>-matrix values for this particular wavelength,</li>
</ul>
<ol style="list-style-type: decimal">
<li>
<code>s</code>, <code>sp</code> are the row (resp. column) index of the multipole mode (1: magnetic, or 2: electric)</li>
<li>
<code>n</code>, <code>np</code> index the multipole degree</li>
<li>
<code>m</code>, <code>mp</code> index the multipole order</li>
<li>
<code>Tr</code>, <code>Ti</code> give the real and imaginary part of the <em>T</em>-matrix element</li>
</ol>
<ul>
<li>If the file contains multiple wavelengths each wavelength-block is appended below the others, starting with a line <code># lambda= N1 nelements= N2</code>
</li>
</ul>
<p>An example is show below,</p>
<pre><code># s sp n np m mp Tr Ti | prolate Au spheroid in water, a = 10 c = 20
# lambda= 400 nelements= 136 epsIn= -1.649657+5.771763j
  1   1   1   1  -1  -1 -1.189109253832815e-04 -2.161746691903687e-05
  1   1   1   1   0   0 -5.597968829951113e-05 -3.444956295771378e-05
... [truncated]
  2   2   4   4   3   3 -3.794740062663782e-11 5.636725538124517e-11
  2   2   4   4   4   4 -1.113090425618089e-11 1.707927691863483e-11
# lambda= 402 nelements= 136 epsIn= -1.661947+5.778032j
  1   1   1   1  -1  -1 -1.160926707256971e-04 -2.119092055798298e-05
  1   1   1   1   0   0 -5.467319805259745e-05 -3.371696756234449e-05
... [truncated]
  2   2   4   4   3   3 -1.279170882307354e-15 1.378894188143029e-13
  2   2   4   4   4   4 -3.752182192799965e-16 4.101975575297762e-14
... [truncated]
# lambda= 800 nelements= 136 epsIn= -24.236565+1.458652j
  1   1   1   1  -1  -1 -7.146139984375531e-07 -1.120611667309835e-05
  1   1   1   1   0   0 -4.379156367712547e-07 -7.955074171282911e-06
... [truncated]
  2   2   4   4   3   3 -1.240958755455683e-15 1.346747233206165e-13
  2   2   4   4   4   4 -3.640885008022631e-16 4.006450678480949e-14
... [truncated]</code></pre>
</div>
<div class="section level3">
<h3 id="dielectricfunctions-nfuns">DielectricFunctions <em>N<sub>funs</sub></em><a class="anchor" aria-label="anchor" href="#dielectricfunctions-nfuns"></a>
</h3>
<p>Specifies the number of custom dielectric functions (default: <em>N<sub>funs</sub> = 0</em>). The subsequent <em>N<sub>funs</sub></em> lines are each read as a string and then interpreted as either (i) a filename with a relative path or (ii) real and imaginary parts of a constant (i.e. wavelength independent) value. Wrap each string in quotation marks, e.g. <code>"../../epsAg.dat"</code> or <code>"2.25d0 0.0d0"</code>. The files should be in three-column format: the wavelength in nm followed by the real and imaginary parts of the relative dielectric function on each line. The wavelength range in the file must fully contain the range specified by the <a href="#wavelength-l1-l2-n-"><code>Wavelength</code></a> keyword, but the values need not correspond exactly as they will be linearly interpolated.</p>
</div>
<div class="section level3">
<h3 id="medium-x">Medium <em>X</em><a class="anchor" aria-label="anchor" href="#medium-x"></a>
</h3>
<p>Sets the real-valued dielectric constant of the host medium (default value is <em>1.0</em>). If <em>X &lt; 0</em> then its magnitude is interpreted as a refractive index (<em>s</em>), from which the dielectric constant is calculated as <span class="math inline">\(X=s^2\)</span>.</p>
</div>
<div class="section level3">
<h3 id="wavelength-l1-l2-n">Wavelength <em>L</em><sub>1</sub> [ <em>L<sub>2</sub></em> <em>n</em> ]<a class="anchor" aria-label="anchor" href="#wavelength-l1-l2-n"></a>
</h3>
<p>Without the optional arguments, this keyword changes the default wavelength of 666.0 nm to a new value <em>L</em><sub>1</sub>. Including the optional arguments will specify a closed interval [ <em>L</em><sub>1</sub>, <em>L</em><sub>2</sub> ] divided into <em>n</em> regular grid spacings, thus producing <em>n+1</em> wavelengths.</p>
</div>
<div class="section level3">
<h3 id="incidence-a-b-c-p-na-nb-nc">Incidence <em>a</em> <em>b</em> <em>c</em> [ <em>p</em> ] / [ <em>n<sub>a</sub></em> <em>n<sub>b</sub></em> <em>n<sub>c</sub></em> ]<a class="anchor" aria-label="anchor" href="#incidence-a-b-c-p-na-nb-nc"></a>
</h3>
<p>or</p>
<p><code>Incidence file filename [p]</code></p>
<p>This keyword modifies the incident plane-wave. The default travel direction (along <em>z</em> in lab-frame) can be changed by the Euler angles <em>a</em> in the range <span class="math inline">\([0,2\pi)\)</span> and <em>b</em> in the range <span class="math inline">\([0,\pi]\)</span>, coinciding with the azimuthal and the polar angles, respectively, of the spherical polar coordinates in the lab frame. In addition, the amplitude vector can then be rotated about the new travel direction by the third Euler angle <em>c</em> in the range <span class="math inline">\([0,2\pi)\)</span>. All three Euler angles are defined in accordance with the right-hand rule, and the sequence of rotation angles <em>a</em>,<em>b</em>,<em>c</em> corresponds to the intrinsic ZY’Z’ convention. That is: rotate by <em>a</em> about the current <em>z</em>-axis, then by <em>b</em> about the new <em>y</em>-axis, and finally by <em>c</em> about the new <em>z</em>-axis.</p>
<p>Near-field and polarimetric calculations, i.e. in modes <em>M = 1</em> and <em>M = 3</em>, require the polarisation of incident light to be specified. The polarisation is set by integer <em>p</em>, with <em>|p| = 1</em> setting linear polarisation, <em>|p| = 2</em> setting circular polarisation, and the sign selecting one of the two Jones vectors in each case (positive: <em>x</em>-linear-polarised or <em>R</em>-circular-polarised; negative: <em>y</em>-linear polarised or <em>L</em>-circular-polarised). Note: for a circularly polarised wave travelling along <em>z</em>, right-circular (<em>R</em>) polarisation means that the amplitude vector is rotating clockwise in the <em>xy</em>-plane from the receiver’s viewpoint (looking in the negative <em>z</em> direction).</p>
<p>The integer <em>p</em> can be omitted in mode <em>M = 2</em>, because its output is always calculated for all four polarisations.</p>
<p>A negative value of argument <em>a</em>, <em>b</em>, and/or <em>c</em> will trigger discretisation of the corresponding angle range to produce <span class="math inline">\(-a\)</span> grid points (resp. <span class="math inline">\(-b\)</span> or <span class="math inline">\(-c\)</span>). The grid points are uniformly spaced for the first and the third Euler angles, but for the second (i.e. polar) angle the discretisation is such that the cosine is uniformly spaced. The range maximum of each angle can be divided by an (optional) integer <em>n<sub>a</sub></em>, <em>n<sub>b</sub></em>, and <em>n<sub>c</sub></em>, to help avoid evaluating redundant grid points in the presence of symmetry. Note that the discretisation is constructed so that orientational averages are computed as a uniformly weighted Riemann sum with the midpoint rule. The weight <em>w<sub>i</sub></em> of each grid-point <em>i</em> is simply <span class="math inline">\(w_i = 1/n_\text{gps}\)</span>, where <em>n<sub>gps</sub></em> is the total number of grid points.</p>
<p>Multiple incidences can also be read from a file, in which case the argument <em>a</em> must be a string starting with ‘f’ or ‘F’, and <em>b</em> must specify the filename. The file’s first line must contain the total incidence count, <em>n<sub>inc</sub></em>, and the subsequent <em>n<sub>inc</sub></em> lines each must contain four space-separated values: the three Euler angles (<em>a<sub>i</sub></em>, <em>b<sub>i</sub></em>, <em>c<sub>i</sub></em>) and the weight <em>w<sub>i</sub></em> of each incidence. The weights are only used to compute rotational averages for convenience, which is a common use-case.</p>
<p>In <code>Mode = 1</code> (near-field calculations), if <code>p</code> is set to <code>p=1</code> (default value, linear polarisaiton), the orientation average of the local degree of optical chirality <span class="math inline">\(\langle\mathscr{C}\rangle\)</span> will be calculated for both RCP and LCP (noting that linear polarisation would give 0 everywhere, when orientation-averaged). Since the calculation can be time-consuming, setting <code>p=+/-2</code> triggers the calculation for only that specific circular polarisation.</p>
</div>
<div class="section level3">
<h3 id="multipolecutoff-n1-n2-t">MultipoleCutoff <em>n<sub>1</sub></em> [ <em>n<sub>2</sub></em> [ <em>t</em> ] ]<a class="anchor" aria-label="anchor" href="#multipolecutoff-n1-n2-t"></a>
</h3>
<p>Change the primary multipole cutoff (used for irregular offsetting when staging the linear system) from the default value of 8 to <em>n<sub>1</sub></em>. Another cutoff (used for regular offsetting when “contracting” the collective <em>T</em>-matrix) can be set to <em>n<sub>2</sub></em> &gt;= <em>n<sub>1</sub></em> (equality by default). A relative tolerance <span class="math inline">\(10^t\)</span> (with <span class="math inline">\(t&lt;0\)</span> and <span class="math inline">\(t = -8\)</span> by default) is used in the test for convergence of cross-sections with respect to multipole order <span class="math inline">\(n=1\dots n_2\)</span> (the summation can terminate below <span class="math inline">\(n_2\)</span> if the relative tolerance is reached).</p>
</div>
<div class="section level3">
<h3 id="multipoleselections-ns">MultipoleSelections <em>N<sub>s</sub></em><a class="anchor" aria-label="anchor" href="#multipoleselections-ns"></a>
</h3>
<p>This keyword defines optional multipole selections for individual <em>T</em>-matrices, and it must be followed by <em>N<sub>s</sub></em> lines with two fields: (i) a string <em>range</em> specifying the selection range; and (ii) a string <em>type</em> specifying the selection type. For example:</p>
<pre><code>MultipoleSelections 3
MM1:4_EM1:4_ME1:4_EE1:4  blocks
MM1:0_EM1:15_ME1:8_EE1:0  rows
EM1:1_ME1:1  columns</code></pre>
<p>The <em>range</em> string must be of the form MM?:?_EM?:?_ME?:?_EE?:?, with the underscores separating the ranges for each <em>T</em>-matrix block (e.g. MM or ME), and each range specified by a closed multipole interval ?:? (e.g. <em>n</em><sub>lo</sub>:<em>n</em><sub>hi</sub> = 1:4). No selection will be applied to blocks not included in <em>range</em>, so these “missing” blocks will remain unmasked (left “as is” in the original <em>T</em>-matrix). On the other hand, a whole block can be masked (zeroed out) by setting <em>n</em><sub>lo</sub> &gt; <em>n</em><sub>hi</sub> (e.g. <code>MM1:0</code> will set the whole <code>MM</code> block of the <em>T</em>-matrix to 0).</p>
<p>The <em>type</em> string must either start from “c”, “r”, or “b”, to indicated that the selection is either applied to <em>T</em>-matrix columns, rows, or both (producing non-zero blocks). To clarify, if <em>type(1:1) = “c”</em>, then all <em>T</em>-matrix columns corresponding to multipole orders <em>n &lt; n</em><sub>lo</sub> and <em>n &gt; n</em><sub>hi</sub> will be set to zero. For <em>type(1:1) = “b”</em>, columns <strong>and</strong> rows for <em>n &lt; n</em><sub>lo</sub> and <em>n &gt; n</em><sub>hi</sub> will be set to zero.</p>
</div>
</div>
<div class="section level2">
<h2 id="output-control">Output control<a class="anchor" aria-label="anchor" href="#output-control"></a>
</h2>
<div class="section level3">
<h3 id="outputformat-f-filename">OutputFormat <em>F</em> [ <em>filename</em> ]<a class="anchor" aria-label="anchor" href="#outputformat-f-filename"></a>
</h3>
<p>If present, the output file format <em>F</em> can be switched between plain text (“TXT”, default) and HDF5 (“HDF5”). With “HDF5”, the results will be stored in a file with name “results.h5”, or a user-specified filename (extension <em>.h5</em> added automatically).</p>
</div>
<div class="section level3">
<h3 id="verbosity-l">Verbosity <em>L</em><a class="anchor" aria-label="anchor" href="#verbosity-l"></a>
</h3>
<p>Keyword specifying integer-valued verbosity level <em>L</em>. Silent mode (<em>L = 0</em>) prints only error statements and warnings. Physical quantities and some status indicators are printed at low verbosity (<em>L = 1</em>, default value), with various timings and convergence indicators released at medium verbosity (<em>L = 2</em>). The highest level (<em>L = 3</em>) is intended for debugging, releasing all print statements throughout the code.</p>
</div>
</div>
<div class="section level2">
<h2 id="near-field-specific-keywords">Near-field specific keywords<a class="anchor" aria-label="anchor" href="#near-field-specific-keywords"></a>
</h2>
<div class="section level3">
<h3 id="spacepoints-filename">SpacePoints <em>filename</em><a class="anchor" aria-label="anchor" href="#spacepoints-filename"></a>
</h3>
<p>or</p>
<p><code>SpacePoints</code> <em>x<sub>lo</sub></em> <em>x<sub>hi</sub></em> <em>n<sub>x</sub></em> <em>y<sub>lo</sub></em> <em>y<sub>hi</sub></em> <em>n<sub>y</sub></em> <em>z<sub>lo</sub></em> <em>z<sub>hi</sub></em> <em>n<sub>z</sub></em></p>
<p>Read (from a file) or calculate (on a regular grid) the Cartesian coordinates of points in space, where the local field quantities are to be evaluated. The file’s first line should contain the total number of space-points, and the subsequent lines must contain the <em>x</em>, <em>y</em>, and <em>z</em> coordinates of each point. A regular grid is specified by a closed interval, e.g. <em>[ x<sub>lo</sub>, x<sub>hi</sub> ]</em>, and the number of bins (<em>n<sub>x</sub></em>) the interval is to be divided into (thus producing <em>n<sub>x</sub>+1</em> grid points along that dimension).</p>
</div>
<div class="section level3">
<h3 id="mapquantity-p-e-b-c">MapQuantity [<em>p</em>] [<em>E</em>] [<em>B</em>] [<em>C</em>]<a class="anchor" aria-label="anchor" href="#mapquantity-p-e-b-c"></a>
</h3>
<p>Specify the near-field quantities of interest, in <code>Mode = 1</code>. Integer argument <em>p</em> selects the raising power applied to the field amplitude <span class="math inline">\(|\mathbf{E}|^p\)</span> or <span class="math inline">\(|\mathbf{B}|^p\)</span>. The default is <em>p = 2</em> to produce the field intensity, <em>p = 1</em> is for the field amplitude |E|, <em>p = 4</em> for the (approximate) Raman enhancement factor <em>~|E|<sup>4</sup></em>. Setting <em>p = 0</em> will output the real and imaginary parts of the (vector!) field components at each space-point.</p>
<p>The optional letters [<em>E</em>] [<em>B</em>] [<em>C</em>] (default: <em>E</em> only) determine which of the near-field properties (electric and magnetic fields and normalised value of local degree of optical chirality) will be calculated.</p>
</div>
<div class="section level3">
<h3 id="mapoaquantity-e-b-c">MapOaQuantity [<em>E</em>] [<em>B</em>] [<em>C</em>]<a class="anchor" aria-label="anchor" href="#mapoaquantity-e-b-c"></a>
</h3>
<p>This is a keyword applicable in <code>Mode = 1</code>, to request the calculation of analytical orientation-averaged near-field quantities <span class="math inline">\(\langle|\mathbf{E}|^2\rangle\)</span>, <span class="math inline">\(\langle|\mathbf{B}|^2\rangle\)</span>, or <span class="math inline">\(\langle\overline{\mathscr{C}}\rangle\)</span>. If this keyword is not included in the input file, by default none will be calculated. Note that the <a href="#incidence-a-b-c-p-na-nb-nc-"><code>Incidence</code></a> keyword is used to select LCP and RCP (or both).</p>
</div>
</div>
<div class="section level2">
<h2 id="polarimetry-keywords">Polarimetry keywords<a class="anchor" aria-label="anchor" href="#polarimetry-keywords"></a>
</h2>
<div class="section level3">
<h3 id="scatteringangles-a-b-c-na-nb-nc">ScatteringAngles <em>a</em> <em>b</em> <em>c</em> / [ <em>n<sub>a</sub></em> <em>n<sub>b</sub></em> <em>n<sub>c</sub></em> ]<a class="anchor" aria-label="anchor" href="#scatteringangles-a-b-c-na-nb-nc"></a>
</h3>
<p>This keyword specifies the scattering angles in <code>Mode = 3</code> (polarimetry), for the calculation of Stokes scattering vectors at different scattering angles. The parameters have the same interpretation as for <a href="#incidence-a-b-c-p-na-nb-nc-"><code>Incidence</code></a>.</p>
<p>Multiple scattering angles can also be read from a file, in which case the argument <code>a</code> must be a string starting with ‘f’ or ‘F’, and <code>b</code> must specify the filename. The file’s first line must contain the number of scattering angles, <em>nsca</em>, and the subsequent <em>nsca</em> lines each must contain three space-separated values: the three Euler angles (<em>ai</em>, <em>bi</em>, <em>ci</em>) for each scattering angle.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="advanced-use-development">Advanced use / development<a class="anchor" aria-label="anchor" href="#advanced-use-development"></a>
</h2>
<div class="section level3">
<h3 id="scatterercentredcrosssections">ScattererCentredCrossSections<a class="anchor" aria-label="anchor" href="#scatterercentredcrosssections"></a>
</h3>
<p>Applicable in Scheme 1 and 2.</p>
<p>Triggers Stout’s formulae for fixed and orientation-averaged cross-sections based on scatterer-centred matrices; otherwise, the default behaviour is to collapse the coefficients to a common origin. Note that this does not affect the calculation of fixed-orientation partial shell absorptions for layered spheres, as they are calculated separately.</p>
</div>
<div class="section level3">
<h3 id="dumpcollectivetmatrix-filename">DumpCollectiveTmatrix [ <em>filename</em> ]<a class="anchor" aria-label="anchor" href="#dumpcollectivetmatrix-filename"></a>
</h3>
<p>If the collective <em>T</em>-matrix is computed, this keyword will dump it to a file “tmat_col.txt” or a user-specified <em>filename</em>. The <a href="#tmatrixfiles-nfiles-1">file format</a> is self-consistent, so that the generated <em>T</em>-matrix can be fed back into <strong>TERMS</strong> for subsequent calculations.</p>
</div>
<div class="section level3">
<h3 id="dumpprestageda">DumpPrestagedA<a class="anchor" aria-label="anchor" href="#dumpprestageda"></a>
</h3>
<p>If present, dumps a sparse-format representation of the full matrix comprising the individual <em>T</em>-matrices after potential masking followed by rotation in their respective frame.</p>
</div>
<div class="section level3">
<h3 id="dumpstageda">DumpStagedA<a class="anchor" aria-label="anchor" href="#dumpstageda"></a>
</h3>
<p>If present, dumps a sparse-format representation of the full matrix comprising the individual <em>T</em>-matrices along the diagonal blocks, and translation matrices in the off-diagonal blocks. The exact form of this matrix is scheme-dependent.</p>
</div>
<div class="section level3">
<h3 id="dumpscacoeff">DumpScaCoeff<a class="anchor" aria-label="anchor" href="#dumpscacoeff"></a>
</h3>
<p>If present, dumps the scattering coefficients in to a file “Sca_coeff” for different incidence angles.</p>
</div>
<div class="section level3">
<h3 id="dumpinccoeff">DumpIncCoeff<a class="anchor" aria-label="anchor" href="#dumpinccoeff"></a>
</h3>
<p>If present, dumps the incident coefficients in to a file “Inc_coeff” for different incidencd angles.</p>
</div>
<div class="section level3">
<h3 id="disablestoutbalancing">DisableStoutBalancing<a class="anchor" aria-label="anchor" href="#disablestoutbalancing"></a>
</h3>
<p>If present, switches off the balancing.</p>
</div>
<div class="section level3">
<h3 id="disablertr">DisableRTR<a class="anchor" aria-label="anchor" href="#disablertr"></a>
</h3>
<p>Switches off the three-step translation of <em>T</em>-matrices, where a general translation is decomposed into a rotation, <em>z</em>-axial translation, and then the inverse rotation. Instead, a one-step transformation is performed by pre- or post-multiplying by a single matrix containing the general translation-addition coefficients.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Dmitri Schebarchov, Atefeh Fazel-Najafabadi, Eric Le Ru, Baptiste Auguié.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
