<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Partial absorption in a core-shell dimer • terms</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="Partial absorption in a core-shell dimer">
<meta property="og:description" content="terms">
<meta property="og:image" content="http://nano-optics.ac.nz/terms/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><link rel="stylesheet" type="text/css" href="../../x3dom.css">
<script type="text/javascript" src="../../x3dom.js"></script><style>
.x3d_scene {
  max-width: 300px;
  width: 80%;
  height: 80%;
  margin: 1em;
  background: rgb(238,251,255);
  background: radial-gradient(circle, rgba(238,251,255,1) 0%, rgba(212,212,212,1) 100%);
 }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">terms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../articles/Keywords.html">Keywords</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Simple examples</li>
    <li>
      <a href="../../articles/01_dimer_spheres/01_dimer_spheres.html">01 dimer spheres</a>
    </li>
    <li>
      <a href="../../articles/02_angular_dispersion/02_angular_dispersion.html">02 angular dispersion</a>
    </li>
    <li>
      <a href="../../articles/03_nearfield_coreshells/03_nearfield_coreshells.html">03 nearfield coreshells</a>
    </li>
    <li>
      <a href="../../articles/04_chiral_dimer_spheroids/04_chiral_dimer_spheroids.html">04 chiral dimer spheroids</a>
    </li>
    <li>
      <a href="../../articles/05_quadrature_averaging/05_quadrature_averaging.html">05 quadrature averaging</a>
    </li>
    <li>
      <a href="../../articles/06_dielectric_function/06_dielectric_function.html">06 dielectric function</a>
    </li>
    <li>
      <a href="../../articles/07_ldoc/07_ldoc.html">07 local degree of chirality</a>
    </li>
    <li>
      <a href="../../articles/08_polarimetry/08_polarimetry.html">08 polarimetry</a>
    </li>
    <li>
      <a href="../../articles/09_spectrum_near_field/09_spectrum_near_field.html">09 orientation-averaged near field spectrum</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Advanced examples &amp; testing</li>
    <li>
      <a href="../../articles/10_shell_absorption/10_shell_absorption.html">10 shell absorption</a>
    </li>
    <li>
      <a href="../../articles/11_convergence/11_convergence.html">11 convergence</a>
    </li>
    <li>
      <a href="../../articles/12_convergence_VTACS/12_convergence_VTACS.html">12 convergence VTACS</a>
    </li>
    <li>
      <a href="../../articles/13_masking/13_masking.html">13 masking</a>
    </li>
    <li>
      <a href="../../articles/14_diffractive_chain/14_diffractive_chain.html">14 diffractive chain</a>
    </li>
    <li>
      <a href="../../articles/15_quadrimer/15_quadrimer.html">15 quadrimer vs 2 dimers</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Technical notes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Convergence and timing studies</li>
    <li>
      <a href="../../articles/101_timing/101_timing.html">101 timing</a>
    </li>
    <li>
      <a href="../../articles/102_comparison_schemes/102_comparison_schemes.html">102 comparison of schemes</a>
    </li>
    <li>
      <a href="../../articles/104_large_separation/104_large_separation.html">104 large separation</a>
    </li>
    <li>
      <a href="../../articles/105_factorised_RTR/105_factorised_RTR.html">105 factorised RTR</a>
    </li>
    <li>
      <a href="../../articles/106_balancing/106_balancing.html">106 balancing</a>
    </li>
    <li>
      <a href="../../articles/109_individual_absorption/109_individual_absorption.html">109 individual absorption</a>
    </li>
    <li>
      <a href="../../articles/110_alpha_tensor/110_alpha_tensor.html">110 alpha tensor</a>
    </li>
    <li>
      <a href="../../articles/111_polarised_nf/111_polarised_nf.html">111 polarised OA near-fields</a>
    </li>
    <li>
      <a href="../../articles/112_absorption_field/112_absorption_field.html">112 core-shell absorption vs internal fields</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Validation</li>
    <li>
      <a href="../../articles/1001_mstm_ff/1001_mstm_ff.html">1001 MSTM far-field</a>
    </li>
    <li>
      <a href="../../articles/1003_cda/1003_cda.html">1003 CDA dichroism</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../../articles/Indexing.html">Indexing conventions</a>
    </li>
    <li>
      <a href="../../articles/Subroutines.html">Code organisation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../news/index.html">Change log</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nano-optics/terms/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Partial absorption in a core-shell dimer</h1>
            
            <h4 data-toc-skip class="date">05 December, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nano-optics/terms/blob/HEAD/vignettes/10_shell_absorption/10_shell_absorption.Rmd" class="external-link"><code>vignettes/10_shell_absorption/10_shell_absorption.Rmd</code></a></small>
      <div class="hidden name"><code>10_shell_absorption.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="objective">Objective<a class="anchor" aria-label="anchor" href="#objective"></a>
</h2>
<p>This example illustrates the calculation of absorption spectra in
core-shell particles, separately for each layer. The structure consists
of two core-shell spheres <code>Au@Ag</code> in water, and for
comparison we also simulate a dummy <code>Au@Au</code> core-shell
structure with the same dimensions.</p>
<style>
.x3d_scene {
float:right;
margin:0em;
 }
  </style>
<p><x3d width="200px" height="150px" class="x3d_scene"><scene><transform scale="30 30 30" rotation="0 0 -1.00001127231894 2.41593653589793" translation="-30.5 0 0"><shape><appearance><material ambientintensity="0.4" diffusecolor="1.0000000 0.8431373 0.0000000" shininess="0.16" specularcolor="0.8549020 0.6470588 0.1254902"></material></appearance><sphere radius="1"></sphere></shape></transform><transform scale="30 30 30" rotation="0 0 -1.00001127231894 2.41593653589793" translation="30.5 0 0"><shape><appearance><material ambientintensity="0.4" diffusecolor="1.0000000 0.8431373 0.0000000" shininess="0.16" specularcolor="0.8549020 0.6470588 0.1254902"></material></appearance><sphere radius="1"></sphere></shape></transform><shape><indexedlineset colorpervertex="false" colorindex="0 1 2" coordindex="0 1 -1 0 2 -1 0 3 -1"><coordinate point="0 0 0 100 0 0 0 100 0 0 0 100"></coordinate><color color="1 0 0 0 1 0 0.2 0.2 1"></color></indexedlineset></shape><viewpoint centerofrotation="0 0 0" position="0 0 150" orientation="0 0 0 1e-05" viewall="false"></viewpoint></scene></x3d></p>
<p>This simulation uses the following <code>input</code> file</p>
<pre><code>ModeAndScheme 2 2
MultipoleCutoff 8
Wavelength 300 800 100
Incidence file incidence
Medium 1.7689 # for water
Verbosity 0
OutputFormat HDF5 cross_sections_AuAg

# 2 spheres spaced by 1nm along x
Scatterers 2
Au@Ag -30.5 0 0 30 29
Au@Ag  30.5 0 0 30 29</code></pre>
<p>Note that currently the partial absorptions are not
orientation-averaged (analytically); we therefore use an external
incident file with quadrature nodes and weights,</p>
<details closed><summary>
Show incidence file (click to open)
</summary><pre><code>38 
 0.00000000  1.57079633  0.00000000  0.00952381
 3.14159265  1.57079633  0.00000000  0.00952381
 1.57079633  1.57079633  0.00000000  0.00952381
-1.57079633  1.57079633  0.00000000  0.00952381
 1.57079633  0.00000000  0.00000000  0.00952381
 1.57079633  3.14159265  0.00000000  0.00952381
 0.78539816  0.95531662  0.00000000  0.03214286
 0.78539816  2.18627604  0.00000000  0.03214286
-0.78539816  0.95531662  0.00000000  0.03214286
-0.78539816  2.18627604  0.00000000  0.03214286
 2.35619449  0.95531662  0.00000000  0.03214286
 2.35619449  2.18627604  0.00000000  0.03214286
-2.35619449  0.95531662  0.00000000  0.03214286
-2.35619449  2.18627604  0.00000000  0.03214286
 1.09313802  1.57079633  0.00000000  0.02857143
-1.09313802  1.57079633  0.00000000  0.02857143
 2.04845464  1.57079633  0.00000000  0.02857143
-2.04845464  1.57079633  0.00000000  0.02857143
 0.47765831  1.57079633  0.00000000  0.02857143
-0.47765831  1.57079633  0.00000000  0.02857143
 2.66393434  1.57079633  0.00000000  0.02857143
-2.66393434  1.57079633  0.00000000  0.02857143
 0.00000000  0.47765831  0.00000000  0.02857143
 0.00000000  2.66393434  0.00000000  0.02857143
 3.14159265  0.47765831  0.00000000  0.02857143
 3.14159265  2.66393434  0.00000000  0.02857143
 0.00000000  1.09313802  0.00000000  0.02857143
 0.00000000  2.04845464  0.00000000  0.02857143
 3.14159265  1.09313802  0.00000000  0.02857143
 3.14159265  2.04845464  0.00000000  0.02857143
 1.57079633  0.47765831  0.00000000  0.02857143
 1.57079633  2.66393434  0.00000000  0.02857143
-1.57079633  0.47765831  0.00000000  0.02857143
-1.57079633  2.66393434  0.00000000  0.02857143
 1.57079633  1.09313802  0.00000000  0.02857143
 1.57079633  2.04845464  0.00000000  0.02857143
-1.57079633  1.09313802  0.00000000  0.02857143
-1.57079633  2.04845464  0.00000000  0.02857143</code></pre>
</details><p><br></p>
<details closed><summary>
Show log file (click to open)
</summary><pre><code>readInputFile&gt; Parsing file input_AuAg

readInputFile&gt; Detected keyword ModeAndScheme
               mode=2 =&gt; spectrum_FF for far-field quantities
               scheme=2 =&gt; Seek T^(ji) using Stout's iterative scheme
readInputFile&gt; Detected keyword MultipoleCutoff
               Supplied ncut(1)=  8
               Setting ncut(2)= ncut(1)
               Setting ncut(3)=  -8
readInputFile&gt; Detected keyword Wavelength
               Wavelength LB (nm):   300.000000
               Wavelength UB (nm):   800.000000
               nsteps, step:       100    5.0000
readInputFile&gt; Detected keyword Incidence
               Incidence filename= incidence
               Expected incidence count=     38
               Incident Euler angles and weights:
                  alpha        beta        gamma        weight
               0.00000000   1.57079633   0.00000000   0.00952381
               3.14159265   1.57079633   0.00000000   0.00952381
               1.57079633   1.57079633   0.00000000   0.00952381
              -1.57079633   1.57079633   0.00000000   0.00952381
               1.57079633   0.00000000   0.00000000   0.00952381
               1.57079633   3.14159265   0.00000000   0.00952381
               0.78539816   0.95531662   0.00000000   0.03214286
               0.78539816   2.18627604   0.00000000   0.03214286
              -0.78539816   0.95531662   0.00000000   0.03214286
              -0.78539816   2.18627604   0.00000000   0.03214286
               2.35619449   0.95531662   0.00000000   0.03214286
               2.35619449   2.18627604   0.00000000   0.03214286
              -2.35619449   0.95531662   0.00000000   0.03214286
              -2.35619449   2.18627604   0.00000000   0.03214286
               1.09313802   1.57079633   0.00000000   0.02857143
              -1.09313802   1.57079633   0.00000000   0.02857143
               2.04845464   1.57079633   0.00000000   0.02857143
              -2.04845464   1.57079633   0.00000000   0.02857143
               0.47765831   1.57079633   0.00000000   0.02857143
              -0.47765831   1.57079633   0.00000000   0.02857143
               2.66393434   1.57079633   0.00000000   0.02857143
              -2.66393434   1.57079633   0.00000000   0.02857143
               0.00000000   0.47765831   0.00000000   0.02857143
               0.00000000   2.66393434   0.00000000   0.02857143
               3.14159265   0.47765831   0.00000000   0.02857143
               3.14159265   2.66393434   0.00000000   0.02857143
               0.00000000   1.09313802   0.00000000   0.02857143
               0.00000000   2.04845464   0.00000000   0.02857143
               3.14159265   1.09313802   0.00000000   0.02857143
               3.14159265   2.04845464   0.00000000   0.02857143
               1.57079633   0.47765831   0.00000000   0.02857143
               1.57079633   2.66393434   0.00000000   0.02857143
              -1.57079633   0.47765831   0.00000000   0.02857143
              -1.57079633   2.66393434   0.00000000   0.02857143
               1.57079633   1.09313802   0.00000000   0.02857143
               1.57079633   2.04845464   0.00000000   0.02857143
              -1.57079633   1.09313802   0.00000000   0.02857143
              -1.57079633   2.04845464   0.00000000   0.02857143
readInputFile&gt; Detected keyword Medium
               Constant host epsilon=  1.7689E+0
readInputFile&gt; Detected keyword Verbosity
               verbosity=     0 (Silent)
readInputFile&gt; Detected keyword OutputFormat
               OutputFormat=HDF5
               All output files are stored in file "cross_sections_AuAg.h5                                          "

readInputFile&gt; Detected keyword Scatterers
 with nscat=    2

readInputFile&gt; Descriptor(s) and circumscribing sphere(s):

 scatID String                  x          y          z         R_0
    1   Au@Ag              -3.0500E+1  0.0000E+0  0.0000E+0  3.0000E+1
    2   Au@Ag               3.0500E+1  0.0000E+0  0.0000E+0  3.0000E+1

readInputFile&gt; Individual geometry characteristic(s):

 scatID Details
    1   Mie with ncoats= 1 R_{-k}:  2.9000E+1
    2   Mie with ncoats= 1 R_{-k}:  2.9000E+1

readInputFile&gt; Dielectric functions for (coated) Mie scatterer(s):

 scatID volID Label
    1     0     Ag
    1    -1     Au
    2     0     Ag
    2    -1     Au

readInputFile&gt; Finished parsing  8 keywords

termsProgram&gt; Program run time (CPU &amp; real in s):  1.461E+01  1.257E+01</code></pre>
</details><p><br></p>
</div>
<div class="section level2">
<h2 id="total-cross-sections">Total cross-sections<a class="anchor" aria-label="anchor" href="#total-cross-sections"></a>
</h2>
<p>We first retrieve the total cross-sections, as usual,</p>
<details closed><summary>
Show output structure (click to open)
</summary><pre><code>                           group                 name       otype dclass
0                              /            Far-Field   H5I_GROUP       
1                     /Far-Field           Incidences H5I_DATASET  FLOAT
2                     /Far-Field          Wavelengths H5I_DATASET  FLOAT
3                     /Far-Field      fixed_incidence   H5I_GROUP       
4     /Far-Field/fixed_incidence              csAbs1X H5I_DATASET  FLOAT
5     /Far-Field/fixed_incidence              csAbs2Y H5I_DATASET  FLOAT
6     /Far-Field/fixed_incidence              csAbs3R H5I_DATASET  FLOAT
7     /Far-Field/fixed_incidence              csAbs4L H5I_DATASET  FLOAT
8     /Far-Field/fixed_incidence              csExt1X H5I_DATASET  FLOAT
9     /Far-Field/fixed_incidence              csExt2Y H5I_DATASET  FLOAT
10    /Far-Field/fixed_incidence              csExt3R H5I_DATASET  FLOAT
11    /Far-Field/fixed_incidence              csExt4L H5I_DATASET  FLOAT
12    /Far-Field/fixed_incidence              csSca1X H5I_DATASET  FLOAT
13    /Far-Field/fixed_incidence              csSca2Y H5I_DATASET  FLOAT
14    /Far-Field/fixed_incidence              csSca3R H5I_DATASET  FLOAT
15    /Far-Field/fixed_incidence              csSca4L H5I_DATASET  FLOAT
16                    /Far-Field         oa_incidence   H5I_GROUP       
17       /Far-Field/oa_incidence              cdAbsOA H5I_DATASET  FLOAT
18       /Far-Field/oa_incidence              cdExtOA H5I_DATASET  FLOAT
19       /Far-Field/oa_incidence              cdScaOA H5I_DATASET  FLOAT
20       /Far-Field/oa_incidence              csAbsOA H5I_DATASET  FLOAT
21       /Far-Field/oa_incidence              csExtOA H5I_DATASET  FLOAT
22       /Far-Field/oa_incidence              csScaOA H5I_DATASET  FLOAT
23                    /Far-Field   partial_absorption   H5I_GROUP       
24 /Far-Field/partial_absorption csAbs1X_scat001coat0 H5I_DATASET  FLOAT
25 /Far-Field/partial_absorption csAbs1X_scat001coat1 H5I_DATASET  FLOAT
26 /Far-Field/partial_absorption csAbs1X_scat002coat0 H5I_DATASET  FLOAT
27 /Far-Field/partial_absorption csAbs1X_scat002coat1 H5I_DATASET  FLOAT
28 /Far-Field/partial_absorption csAbs2Y_scat001coat0 H5I_DATASET  FLOAT
29 /Far-Field/partial_absorption csAbs2Y_scat001coat1 H5I_DATASET  FLOAT
30 /Far-Field/partial_absorption csAbs2Y_scat002coat0 H5I_DATASET  FLOAT
31 /Far-Field/partial_absorption csAbs2Y_scat002coat1 H5I_DATASET  FLOAT
32 /Far-Field/partial_absorption csAbs3R_scat001coat0 H5I_DATASET  FLOAT
33 /Far-Field/partial_absorption csAbs3R_scat001coat1 H5I_DATASET  FLOAT
34 /Far-Field/partial_absorption csAbs3R_scat002coat0 H5I_DATASET  FLOAT
35 /Far-Field/partial_absorption csAbs3R_scat002coat1 H5I_DATASET  FLOAT
36 /Far-Field/partial_absorption csAbs4L_scat001coat0 H5I_DATASET  FLOAT
37 /Far-Field/partial_absorption csAbs4L_scat001coat1 H5I_DATASET  FLOAT
38 /Far-Field/partial_absorption csAbs4L_scat002coat0 H5I_DATASET  FLOAT
39 /Far-Field/partial_absorption csAbs4L_scat002coat1 H5I_DATASET  FLOAT
        dim
0          
1    38 x 4
2       101
3          
4  101 x 39
5  101 x 39
6  101 x 39
7  101 x 39
8  101 x 39
9  101 x 39
10 101 x 39
11 101 x 39
12 101 x 39
13 101 x 39
14 101 x 39
15 101 x 39
16         
17  101 x 9
18  101 x 9
19  101 x 9
20  101 x 9
21  101 x 9
22  101 x 9
23         
24 101 x 39
25 101 x 39
26 101 x 39
27 101 x 39
28 101 x 39
29 101 x 39
30 101 x 39
31 101 x 39
32 101 x 39
33 101 x 39
34 101 x 39
35 101 x 39
36 101 x 39
37 101 x 39
38 101 x 39
39 101 x 39</code></pre>
<pre><code>Rows: 606
Columns: 6
$ wavelength &lt;dbl&gt; 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 355,…
$ crosstype  &lt;chr&gt; "Abs", "Abs", "Abs", "Abs", "Abs", "Abs", "Abs", "Abs", "Ab…
$ variable   &lt;chr&gt; "total", "total", "total", "total", "total", "total", "tota…
$ dichroism  &lt;dbl&gt; -1.055521e-11, -1.091371e-11, -1.003158e-11, -1.083340e-11,…
$ average    &lt;dbl&gt; 9862.443, 9854.690, 9843.744, 9831.910, 9821.330, 9813.848,…
$ case       &lt;chr&gt; "Au@Au", "Au@Au", "Au@Au", "Au@Au", "Au@Au", "Au@Au", "Au@A…</code></pre>
</details><p><br></p>
</div>
<div class="section level2">
<h2 id="per-layer-absorption">Per-layer absorption<a class="anchor" aria-label="anchor" href="#per-layer-absorption"></a>
</h2>
<p>Additional files/fields in the form
<code>csAbs4L_scat00{i}coat{i}</code> are created for each layered
sphere, containing partial absorption cross-sections for particle <span class="math inline">\({i}\)</span>, up to layer <span class="math inline">\({j}\)</span>, with columns for each angle of
incidence and the weighted average,</p>
<p>To get the per-layer absorption we need to take the difference
between successive coats.</p>
<pre><code>Rows: 808
Columns: 5
Groups: scatterer, wavelength, polarisation [808]
$ polarisation &lt;chr&gt; "1X", "1X", "1X", "1X", "1X", "1X", "1X", "1X", "1X", "1X…
$ scatterer    &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ wavelength   &lt;dbl&gt; 300, 305, 310, 315, 320, 325, 330, 335, 340, 345, 350, 35…
$ partial_0    &lt;dbl&gt; 4374.818, 4371.182, 4366.010, 4360.373, 4355.259, 4351.50…
$ partial_1    &lt;dbl&gt; 4954.835, 4945.920, 4935.638, 4925.236, 4915.845, 4908.41…</code></pre>
<pre><code>Rows: 1,212
Columns: 6
$ scatterer  &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
$ wavelength &lt;dbl&gt; 300, 300, 300, 305, 305, 305, 310, 310, 310, 315, 315, 315,…
$ region     &lt;chr&gt; "total_avg", "shell_avg", "core_avg", "total_avg", "shell_a…
$ value      &lt;dbl&gt; 4931.2215, 586.2634, 4344.9581, 4927.3451, 581.5501, 4345.7…
$ case       &lt;chr&gt; "Au@Au", "Au@Au", "Au@Au", "Au@Au", "Au@Au", "Au@Au", "Au@A…
$ crosstype  &lt;chr&gt; "Abs", "Abs", "Abs", "Abs", "Abs", "Abs", "Abs", "Abs", "Ab…</code></pre>
<p>In this plot the total absorption and per-particle absorption for the
core-shell coincide.</p>
<p><img src="10_shell_absorption_files/figure-html/comparison-1.png" width="700"></p>
<p>The absorption in the Ag layer is maximum at the plasmon resonance of
the dimer, the position of which is largely dictated by the gold
cores.</p>
<hr>
<p><em>Last run: 05 December, 2023</em></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Dmitri Schebarchov, Atefeh Fazel-Najafabadi, Eric Le Ru, Baptiste Auguié.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
